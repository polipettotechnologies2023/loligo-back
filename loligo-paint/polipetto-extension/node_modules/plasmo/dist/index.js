#!/usr/bin/env node
import { createRequire } from 'module';const require = createRequire(import.meta.url);
var Tl=Object.create;var rn=Object.defineProperty;var Ml=Object.getOwnPropertyDescriptor;var Il=Object.getOwnPropertyNames;var Dl=Object.getPrototypeOf,Fl=Object.prototype.hasOwnProperty;var v=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var y=(t,e)=>()=>(t&&(e=t(t=0)),e);var x=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),ze=(t,e)=>{for(var r in e)rn(t,r,{get:e[r],enumerable:!0})},Al=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Il(e))!Fl.call(t,i)&&i!==r&&rn(t,i,{get:()=>e[i],enumerable:!(n=Ml(e,i))||n.enumerable});return t};var A=(t,e,r)=>(r=t!=null?Tl(Dl(t)):{},Al(e||!t||!t.__esModule?rn(r,"default",{value:t,enumerable:!0}):r,t));var nt,Zt,er=y(()=>{nt=typeof globalThis.process<"u"?globalThis.process.argv:[],Zt=(t=nt[2])=>nt.filter(e=>!e.startsWith("--")).slice(nt.indexOf(t)+1)});var nn,$l,Ni,on=y(()=>{nn=()=>typeof globalThis.process<"u"?globalThis.process.env:{},$l=/\$([\w+]+)/gm,Ni=(t,e=nn(),r=$l)=>t.replace(r,(n,i)=>e[i]||n)});var Rl,R,Bl,H,dg,bt,Ti,pe=y(()=>{er();on();Rl=new Set(nt),R=t=>Rl.has(t),Bl=nt.filter(t=>t.startsWith("--")&&t.includes("=")).map(t=>t.split("=")).reduce((t,[e,r])=>(t[e]=r,t),{}),H=t=>Bl[t],dg=R("--dry-run"),bt=()=>R("--verbose")||nn().VERBOSE==="true",Ti=bt()});var xe,Mi,Me,le,M,Z,jl,m,b=y(()=>{pe();xe=(t="",...e)=>console.log(t.padEnd(9),"|",...e),Mi=(...t)=>xe("",...t),Me=(...t)=>xe("\u{1F7E2} DONE",...t),le=(...t)=>console.error("\u{1F534} ERROR".padEnd(9),"|",...t),M=(...t)=>xe("\u{1F535} INFO",...t),Z=(...t)=>xe("\u{1F7E0} WARN",...t),jl=0,m=(...t)=>bt()&&xe(`\u{1F7E1} ${jl++}`,...t)});import{kebabCase as ql}from"change-case";var Ie,Fi,it=y(()=>{pe();Ie=()=>{let t=H("--src-path")||process.env.PLASMO_SRC_PATH||"src",e=H("--build-path")||process.env.PLASMO_BUILD_PATH||"build",r=H("--tag")||process.env.PLASMO_TAG||(process.env.NODE_ENV==="production"?"prod":"dev"),n=ql(H("--target")||process.env.PLASMO_TARGET||"chrome-mv3"),[i,o]=n.split("-"),s=H("--entry")||"popup",a=H("--env");return{browser:i,manifestVersion:o,tag:r,srcPath:t,buildPath:e,target:n,entry:s,envPath:a}},Fi=`
    
    init

      --entry                     entry files (default: popup)
      --with-<name>               use an example template

    dev/build     

      --target [string]           set the target (default: chrome-mv3)
      --tag [string]              set the build tag (default: dev or prod depending on NODE_ENV)
      --src-path [path]           set the source path relative to project root (default: src)
      --build-path [path]         set the build path relative to project root (default: build)
      --entry                     entry point name (default: popup)
      --env                       relative path to top-level env file
`});var fe,tr,Ye=y(()=>{b();an();it();fe=()=>{console.log("\u{1F7E3} Plasmo v0.84.2"),console.log("\u{1F534} The Browser Extension Framework")},tr=()=>{xe("\u{1F7E0} CMDS",sn.join(" | ")),xe("\u{1F7E1} OPTS",Fi)}});var Ai={};ze(Ai,{default:()=>Vl});async function Wl(){fe(),tr()}var Vl,$i=y(()=>{Ye();Vl=Wl});var Ri={};ze(Ri,{default:()=>Gl});async function Hl(){M("Start the extension development...")}var Gl,Bi=y(()=>{b();Gl=Hl});import{constants as cn}from"fs";import{access as Jl,mkdir as zl,readdir as Yl,stat as ji}from"fs/promises";async function ln(t,e){try{return await Jl(t,e),!0}catch{return!1}}async function rr(t){return ln(t,cn.W_OK)}async function nr(t){return ln(t,cn.R_OK)}async function F(t){return ln(t,cn.F_OK)}async function Ui(t){try{return(await ji(t)).isDirectory()}catch{return!1}}async function ir(t){try{return(await ji(t)).isFile()}catch{return!1}}async function Xl(t){let e=(await Yl(t,{withFileTypes:!0})).filter(r=>!Kl.has(r.name)).filter(r=>!/\.iml$/.test(r.name));if(e.length>0){m(`Found conflicting contents in ${t}`);let r=e.reduce((n,i)=>`${n}
	${i.name}${i.isDirectory()?"/":""}`,"");return m(r),!1}return!0}async function qi(t){if(!await rr(t))m("Directory does not exist, creating..."),await zl(t);else{if(m("Directory exists, checking if it is empty..."),!await Xl(t))throw new Error(`Directory ${t} is not empty.`);if(m("Checking if directory is writable..."),!await rr(t))throw new Error(`Directory ${t} is not accesible.`)}}var Kl,Y=y(()=>{b();Kl=new Set([".DS_Store",".git",".gitattributes",".gitignore",".gitlab-ci.yml",".hg",".hgcheck",".hgignore",".idea",".npmignore",".travis.yml","LICENSE","Thumbs.db","docs","mkdocs.yml","npm-debug.log","yarn-debug.log","yarn-error.log",".pnpm-debug.log"])});import{existsSync as Ql}from"fs";import{basename as Zl,resolve as ue}from"path";import{cwd as ef}from"process";var ot,or=y(()=>{it();ot=(t=ef())=>{let e=Ie();process.env.PLASMO_PROJECT_DIR=t;let r=Zl(t);process.env.PLASMO_SRC_PATH=e.srcPath;let n=ue(t,e.srcPath);process.env.PLASMO_SRC_DIR=Ql(n)?n:t,process.env.PLASMO_BUILD_PATH=e.buildPath;let i=ue(t,e.buildPath);process.env.PLASMO_BUILD_DIR=i;let o=`${e.target}-${e.tag}`,s=ue(i,o),a=ue(t,".plasmo"),l=ue(a,"cache");return{packageName:r,projectDirectory:t,buildDirectory:i,distDirectory:s,distDirectoryName:o,sourceDirectory:process.env.PLASMO_SRC_DIR,packageFilePath:ue(t,"package.json"),gitIgnorePath:ue(t,".gitignore"),assetsDirectory:ue(t,"assets"),dotPlasmoDirectory:a,cacheDirectory:l,plasmoVersionFilePath:ue(l,"plasmo.version.json"),staticDirectory:ue(a,"static"),genAssetsDirectory:ue(a,"gen-assets"),entryManifestPath:ue(a,`${e.target}.plasmo.manifest.json`)}}});import tf from"@expo/spawn-async";import rf from"semver";async function fn(t){let e=await tf(t,["--version"]),r=rf.valid(e.stdout.trim())||void 0;return{name:t,version:r}}async function st(){try{let t=process.env.npm_config_user_agent;if(t){if(t.startsWith("yarn"))return{name:"yarn"};if(t.startsWith("pnpm"))return{name:"pnpm"}}try{return await fn("pnpm")}catch{return await fn("yarn")}}catch{return await fn("npm")}}var sr=y(()=>{});var ee=x(un=>{"use strict";un.fromCallback=function(t){return Object.defineProperty(function(...e){if(typeof e[e.length-1]=="function")t.apply(this,e);else return new Promise((r,n)=>{t.call(this,...e,(i,o)=>i!=null?n(i):r(o))})},"name",{value:t.name})};un.fromPromise=function(t){return Object.defineProperty(function(...e){let r=e[e.length-1];if(typeof r!="function")return t.apply(this,e);t.apply(this,e.slice(0,-1)).then(n=>r(null,n),r)},"name",{value:t.name})}});var Vi=x((Wg,Wi)=>{var De=v("constants"),nf=process.cwd,ar=null,of=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return ar||(ar=nf.call(process)),ar};try{process.cwd()}catch{}typeof process.chdir=="function"&&(pn=process.chdir,process.chdir=function(t){ar=null,pn.call(process,t)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,pn));var pn;Wi.exports=sf;function sf(t){De.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&e(t),t.lutimes||r(t),t.chown=o(t.chown),t.fchown=o(t.fchown),t.lchown=o(t.lchown),t.chmod=n(t.chmod),t.fchmod=n(t.fchmod),t.lchmod=n(t.lchmod),t.chownSync=s(t.chownSync),t.fchownSync=s(t.fchownSync),t.lchownSync=s(t.lchownSync),t.chmodSync=i(t.chmodSync),t.fchmodSync=i(t.fchmodSync),t.lchmodSync=i(t.lchmodSync),t.stat=a(t.stat),t.fstat=a(t.fstat),t.lstat=a(t.lstat),t.statSync=l(t.statSync),t.fstatSync=l(t.fstatSync),t.lstatSync=l(t.lstatSync),t.chmod&&!t.lchmod&&(t.lchmod=function(c,u,p){p&&process.nextTick(p)},t.lchmodSync=function(){}),t.chown&&!t.lchown&&(t.lchown=function(c,u,p,d){d&&process.nextTick(d)},t.lchownSync=function(){}),of==="win32"&&(t.rename=typeof t.rename!="function"?t.rename:function(c){function u(p,d,h){var g=Date.now(),_=0;c(p,d,function S(C){if(C&&(C.code==="EACCES"||C.code==="EPERM"||C.code==="EBUSY")&&Date.now()-g<6e4){setTimeout(function(){t.stat(d,function(O,W){O&&O.code==="ENOENT"?c(p,d,S):h(C)})},_),_<100&&(_+=10);return}h&&h(C)})}return Object.setPrototypeOf&&Object.setPrototypeOf(u,c),u}(t.rename)),t.read=typeof t.read!="function"?t.read:function(c){function u(p,d,h,g,_,S){var C;if(S&&typeof S=="function"){var O=0;C=function(W,Te,Pe){if(W&&W.code==="EAGAIN"&&O<10)return O++,c.call(t,p,d,h,g,_,C);S.apply(this,arguments)}}return c.call(t,p,d,h,g,_,C)}return Object.setPrototypeOf&&Object.setPrototypeOf(u,c),u}(t.read),t.readSync=typeof t.readSync!="function"?t.readSync:function(c){return function(u,p,d,h,g){for(var _=0;;)try{return c.call(t,u,p,d,h,g)}catch(S){if(S.code==="EAGAIN"&&_<10){_++;continue}throw S}}}(t.readSync);function e(c){c.lchmod=function(u,p,d){c.open(u,De.O_WRONLY|De.O_SYMLINK,p,function(h,g){if(h){d&&d(h);return}c.fchmod(g,p,function(_){c.close(g,function(S){d&&d(_||S)})})})},c.lchmodSync=function(u,p){var d=c.openSync(u,De.O_WRONLY|De.O_SYMLINK,p),h=!0,g;try{g=c.fchmodSync(d,p),h=!1}finally{if(h)try{c.closeSync(d)}catch{}else c.closeSync(d)}return g}}function r(c){De.hasOwnProperty("O_SYMLINK")&&c.futimes?(c.lutimes=function(u,p,d,h){c.open(u,De.O_SYMLINK,function(g,_){if(g){h&&h(g);return}c.futimes(_,p,d,function(S){c.close(_,function(C){h&&h(S||C)})})})},c.lutimesSync=function(u,p,d){var h=c.openSync(u,De.O_SYMLINK),g,_=!0;try{g=c.futimesSync(h,p,d),_=!1}finally{if(_)try{c.closeSync(h)}catch{}else c.closeSync(h)}return g}):c.futimes&&(c.lutimes=function(u,p,d,h){h&&process.nextTick(h)},c.lutimesSync=function(){})}function n(c){return c&&function(u,p,d){return c.call(t,u,p,function(h){f(h)&&(h=null),d&&d.apply(this,arguments)})}}function i(c){return c&&function(u,p){try{return c.call(t,u,p)}catch(d){if(!f(d))throw d}}}function o(c){return c&&function(u,p,d,h){return c.call(t,u,p,d,function(g){f(g)&&(g=null),h&&h.apply(this,arguments)})}}function s(c){return c&&function(u,p,d){try{return c.call(t,u,p,d)}catch(h){if(!f(h))throw h}}}function a(c){return c&&function(u,p,d){typeof p=="function"&&(d=p,p=null);function h(g,_){_&&(_.uid<0&&(_.uid+=4294967296),_.gid<0&&(_.gid+=4294967296)),d&&d.apply(this,arguments)}return p?c.call(t,u,p,h):c.call(t,u,h)}}function l(c){return c&&function(u,p){var d=p?c.call(t,u,p):c.call(t,u);return d&&(d.uid<0&&(d.uid+=4294967296),d.gid<0&&(d.gid+=4294967296)),d}}function f(c){if(!c||c.code==="ENOSYS")return!0;var u=!process.getuid||process.getuid()!==0;return!!(u&&(c.code==="EINVAL"||c.code==="EPERM"))}}});var Ji=x((Vg,Gi)=>{var Hi=v("stream").Stream;Gi.exports=af;function af(t){return{ReadStream:e,WriteStream:r};function e(n,i){if(!(this instanceof e))return new e(n,i);Hi.call(this);var o=this;this.path=n,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=64*1024,i=i||{};for(var s=Object.keys(i),a=0,l=s.length;a<l;a++){var f=s[a];this[f]=i[f]}if(this.encoding&&this.setEncoding(this.encoding),this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.end===void 0)this.end=1/0;else if(typeof this.end!="number")throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(this.fd!==null){process.nextTick(function(){o._read()});return}t.open(this.path,this.flags,this.mode,function(c,u){if(c){o.emit("error",c),o.readable=!1;return}o.fd=u,o.emit("open",u),o._read()})}function r(n,i){if(!(this instanceof r))return new r(n,i);Hi.call(this),this.path=n,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,i=i||{};for(var o=Object.keys(i),s=0,a=o.length;s<a;s++){var l=o[s];this[l]=i[l]}if(this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],this.fd===null&&(this._open=t.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}});var Yi=x((Hg,zi)=>{"use strict";zi.exports=lf;var cf=Object.getPrototypeOf||function(t){return t.__proto__};function lf(t){if(t===null||typeof t!="object")return t;if(t instanceof Object)var e={__proto__:cf(t)};else var e=Object.create(null);return Object.getOwnPropertyNames(t).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}});var te=x((Gg,hn)=>{var D=v("fs"),ff=Vi(),uf=Ji(),pf=Yi(),cr=v("util"),G,fr;typeof Symbol=="function"&&typeof Symbol.for=="function"?(G=Symbol.for("graceful-fs.queue"),fr=Symbol.for("graceful-fs.previous")):(G="___graceful-fs.queue",fr="___graceful-fs.previous");function mf(){}function Qi(t,e){Object.defineProperty(t,G,{get:function(){return e}})}var Ke=mf;cr.debuglog?Ke=cr.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(Ke=function(){var t=cr.format.apply(cr,arguments);t="GFS4: "+t.split(/\n/).join(`
GFS4: `),console.error(t)});D[G]||(Ki=global[G]||[],Qi(D,Ki),D.close=function(t){function e(r,n){return t.call(D,r,function(i){i||Xi(),typeof n=="function"&&n.apply(this,arguments)})}return Object.defineProperty(e,fr,{value:t}),e}(D.close),D.closeSync=function(t){function e(r){t.apply(D,arguments),Xi()}return Object.defineProperty(e,fr,{value:t}),e}(D.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){Ke(D[G]),v("assert").equal(D[G].length,0)}));var Ki;global[G]||Qi(global,D[G]);hn.exports=mn(pf(D));process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!D.__patched&&(hn.exports=mn(D),D.__patched=!0);function mn(t){ff(t),t.gracefulify=mn,t.createReadStream=Te,t.createWriteStream=Pe;var e=t.readFile;t.readFile=r;function r(w,k,E){return typeof k=="function"&&(E=k,k=null),B(w,k,E);function B(j,P,L,N){return e(j,P,function(T){T&&(T.code==="EMFILE"||T.code==="ENFILE")?at([B,[j,P,L],T,N||Date.now(),Date.now()]):typeof L=="function"&&L.apply(this,arguments)})}}var n=t.writeFile;t.writeFile=i;function i(w,k,E,B){return typeof E=="function"&&(B=E,E=null),j(w,k,E,B);function j(P,L,N,T,V){return n(P,L,N,function(I){I&&(I.code==="EMFILE"||I.code==="ENFILE")?at([j,[P,L,N,T],I,V||Date.now(),Date.now()]):typeof T=="function"&&T.apply(this,arguments)})}}var o=t.appendFile;o&&(t.appendFile=s);function s(w,k,E,B){return typeof E=="function"&&(B=E,E=null),j(w,k,E,B);function j(P,L,N,T,V){return o(P,L,N,function(I){I&&(I.code==="EMFILE"||I.code==="ENFILE")?at([j,[P,L,N,T],I,V||Date.now(),Date.now()]):typeof T=="function"&&T.apply(this,arguments)})}}var a=t.copyFile;a&&(t.copyFile=l);function l(w,k,E,B){return typeof E=="function"&&(B=E,E=0),j(w,k,E,B);function j(P,L,N,T,V){return a(P,L,N,function(I){I&&(I.code==="EMFILE"||I.code==="ENFILE")?at([j,[P,L,N,T],I,V||Date.now(),Date.now()]):typeof T=="function"&&T.apply(this,arguments)})}}var f=t.readdir;t.readdir=u;var c=/^v[0-5]\./;function u(w,k,E){typeof k=="function"&&(E=k,k=null);var B=c.test(process.version)?function(L,N,T,V){return f(L,j(L,N,T,V))}:function(L,N,T,V){return f(L,N,j(L,N,T,V))};return B(w,k,E);function j(P,L,N,T){return function(V,I){V&&(V.code==="EMFILE"||V.code==="ENFILE")?at([B,[P,L,N],V,T||Date.now(),Date.now()]):(I&&I.sort&&I.sort(),typeof N=="function"&&N.call(this,V,I))}}}if(process.version.substr(0,4)==="v0.8"){var p=uf(t);S=p.ReadStream,O=p.WriteStream}var d=t.ReadStream;d&&(S.prototype=Object.create(d.prototype),S.prototype.open=C);var h=t.WriteStream;h&&(O.prototype=Object.create(h.prototype),O.prototype.open=W),Object.defineProperty(t,"ReadStream",{get:function(){return S},set:function(w){S=w},enumerable:!0,configurable:!0}),Object.defineProperty(t,"WriteStream",{get:function(){return O},set:function(w){O=w},enumerable:!0,configurable:!0});var g=S;Object.defineProperty(t,"FileReadStream",{get:function(){return g},set:function(w){g=w},enumerable:!0,configurable:!0});var _=O;Object.defineProperty(t,"FileWriteStream",{get:function(){return _},set:function(w){_=w},enumerable:!0,configurable:!0});function S(w,k){return this instanceof S?(d.apply(this,arguments),this):S.apply(Object.create(S.prototype),arguments)}function C(){var w=this;we(w.path,w.flags,w.mode,function(k,E){k?(w.autoClose&&w.destroy(),w.emit("error",k)):(w.fd=E,w.emit("open",E),w.read())})}function O(w,k){return this instanceof O?(h.apply(this,arguments),this):O.apply(Object.create(O.prototype),arguments)}function W(){var w=this;we(w.path,w.flags,w.mode,function(k,E){k?(w.destroy(),w.emit("error",k)):(w.fd=E,w.emit("open",E))})}function Te(w,k){return new t.ReadStream(w,k)}function Pe(w,k){return new t.WriteStream(w,k)}var Je=t.open;t.open=we;function we(w,k,E,B){return typeof E=="function"&&(B=E,E=null),j(w,k,E,B);function j(P,L,N,T,V){return Je(P,L,N,function(I,ag){I&&(I.code==="EMFILE"||I.code==="ENFILE")?at([j,[P,L,N,T],I,V||Date.now(),Date.now()]):typeof T=="function"&&T.apply(this,arguments)})}}return t}function at(t){Ke("ENQUEUE",t[0].name,t[1]),D[G].push(t),dn()}var lr;function Xi(){for(var t=Date.now(),e=0;e<D[G].length;++e)D[G][e].length>2&&(D[G][e][3]=t,D[G][e][4]=t);dn()}function dn(){if(clearTimeout(lr),lr=void 0,D[G].length!==0){var t=D[G].shift(),e=t[0],r=t[1],n=t[2],i=t[3],o=t[4];if(i===void 0)Ke("RETRY",e.name,r),e.apply(null,r);else if(Date.now()-i>=6e4){Ke("TIMEOUT",e.name,r);var s=r.pop();typeof s=="function"&&s.call(null,n)}else{var a=Date.now()-o,l=Math.max(o-i,1),f=Math.min(l*1.2,100);a>=f?(Ke("RETRY",e.name,r),e.apply(null,r.concat([i]))):D[G].push(t)}lr===void 0&&(lr=setTimeout(dn,0))}}});var Xe=x(be=>{"use strict";var Zi=ee().fromCallback,K=te(),df=["access","appendFile","chmod","chown","close","copyFile","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","lchmod","lchown","link","lstat","mkdir","mkdtemp","open","opendir","readdir","readFile","readlink","realpath","rename","rm","rmdir","stat","symlink","truncate","unlink","utimes","writeFile"].filter(t=>typeof K[t]=="function");Object.assign(be,K);df.forEach(t=>{be[t]=Zi(K[t])});be.exists=function(t,e){return typeof e=="function"?K.exists(t,e):new Promise(r=>K.exists(t,r))};be.read=function(t,e,r,n,i,o){return typeof o=="function"?K.read(t,e,r,n,i,o):new Promise((s,a)=>{K.read(t,e,r,n,i,(l,f,c)=>{if(l)return a(l);s({bytesRead:f,buffer:c})})})};be.write=function(t,e,...r){return typeof r[r.length-1]=="function"?K.write(t,e,...r):new Promise((n,i)=>{K.write(t,e,...r,(o,s,a)=>{if(o)return i(o);n({bytesWritten:s,buffer:a})})})};be.readv=function(t,e,...r){return typeof r[r.length-1]=="function"?K.readv(t,e,...r):new Promise((n,i)=>{K.readv(t,e,...r,(o,s,a)=>{if(o)return i(o);n({bytesRead:s,buffers:a})})})};be.writev=function(t,e,...r){return typeof r[r.length-1]=="function"?K.writev(t,e,...r):new Promise((n,i)=>{K.writev(t,e,...r,(o,s,a)=>{if(o)return i(o);n({bytesWritten:s,buffers:a})})})};typeof K.realpath.native=="function"?be.realpath.native=Zi(K.realpath.native):process.emitWarning("fs.realpath.native is not a function. Is fs being monkey-patched?","Warning","fs-extra-WARN0003")});var to=x((zg,eo)=>{"use strict";var hf=v("path");eo.exports.checkPath=function(e){if(process.platform==="win32"&&/[<>:"|?*]/.test(e.replace(hf.parse(e).root,""))){let n=new Error(`Path contains invalid characters: ${e}`);throw n.code="EINVAL",n}}});var oo=x((Yg,gn)=>{"use strict";var ro=Xe(),{checkPath:no}=to(),io=t=>{let e={mode:511};return typeof t=="number"?t:{...e,...t}.mode};gn.exports.makeDir=async(t,e)=>(no(t),ro.mkdir(t,{mode:io(e),recursive:!0}));gn.exports.makeDirSync=(t,e)=>(no(t),ro.mkdirSync(t,{mode:io(e),recursive:!0}))});var me=x((Kg,so)=>{"use strict";var gf=ee().fromPromise,{makeDir:yf,makeDirSync:yn}=oo(),_n=gf(yf);so.exports={mkdirs:_n,mkdirsSync:yn,mkdirp:_n,mkdirpSync:yn,ensureDir:_n,ensureDirSync:yn}});var Fe=x((Xg,co)=>{"use strict";var _f=ee().fromPromise,ao=Xe();function wf(t){return ao.access(t).then(()=>!0).catch(()=>!1)}co.exports={pathExists:_f(wf),pathExistsSync:ao.existsSync}});var wn=x((Qg,lo)=>{"use strict";var ct=te();function xf(t,e,r,n){ct.open(t,"r+",(i,o)=>{if(i)return n(i);ct.futimes(o,e,r,s=>{ct.close(o,a=>{n&&n(s||a)})})})}function vf(t,e,r){let n=ct.openSync(t,"r+");return ct.futimesSync(n,e,r),ct.closeSync(n)}lo.exports={utimesMillis:xf,utimesMillisSync:vf}});var Qe=x((Zg,po)=>{"use strict";var lt=Xe(),U=v("path"),Sf=v("util");function Ef(t,e,r){let n=r.dereference?i=>lt.stat(i,{bigint:!0}):i=>lt.lstat(i,{bigint:!0});return Promise.all([n(t),n(e).catch(i=>{if(i.code==="ENOENT")return null;throw i})]).then(([i,o])=>({srcStat:i,destStat:o}))}function Pf(t,e,r){let n,i=r.dereference?s=>lt.statSync(s,{bigint:!0}):s=>lt.lstatSync(s,{bigint:!0}),o=i(t);try{n=i(e)}catch(s){if(s.code==="ENOENT")return{srcStat:o,destStat:null};throw s}return{srcStat:o,destStat:n}}function bf(t,e,r,n,i){Sf.callbackify(Ef)(t,e,n,(o,s)=>{if(o)return i(o);let{srcStat:a,destStat:l}=s;if(l){if(kt(a,l)){let f=U.basename(t),c=U.basename(e);return r==="move"&&f!==c&&f.toLowerCase()===c.toLowerCase()?i(null,{srcStat:a,destStat:l,isChangingCase:!0}):i(new Error("Source and destination must not be the same."))}if(a.isDirectory()&&!l.isDirectory())return i(new Error(`Cannot overwrite non-directory '${e}' with directory '${t}'.`));if(!a.isDirectory()&&l.isDirectory())return i(new Error(`Cannot overwrite directory '${e}' with non-directory '${t}'.`))}return a.isDirectory()&&xn(t,e)?i(new Error(ur(t,e,r))):i(null,{srcStat:a,destStat:l})})}function kf(t,e,r,n){let{srcStat:i,destStat:o}=Pf(t,e,n);if(o){if(kt(i,o)){let s=U.basename(t),a=U.basename(e);if(r==="move"&&s!==a&&s.toLowerCase()===a.toLowerCase())return{srcStat:i,destStat:o,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(i.isDirectory()&&!o.isDirectory())throw new Error(`Cannot overwrite non-directory '${e}' with directory '${t}'.`);if(!i.isDirectory()&&o.isDirectory())throw new Error(`Cannot overwrite directory '${e}' with non-directory '${t}'.`)}if(i.isDirectory()&&xn(t,e))throw new Error(ur(t,e,r));return{srcStat:i,destStat:o}}function fo(t,e,r,n,i){let o=U.resolve(U.dirname(t)),s=U.resolve(U.dirname(r));if(s===o||s===U.parse(s).root)return i();lt.stat(s,{bigint:!0},(a,l)=>a?a.code==="ENOENT"?i():i(a):kt(e,l)?i(new Error(ur(t,r,n))):fo(t,e,s,n,i))}function uo(t,e,r,n){let i=U.resolve(U.dirname(t)),o=U.resolve(U.dirname(r));if(o===i||o===U.parse(o).root)return;let s;try{s=lt.statSync(o,{bigint:!0})}catch(a){if(a.code==="ENOENT")return;throw a}if(kt(e,s))throw new Error(ur(t,r,n));return uo(t,e,o,n)}function kt(t,e){return e.ino&&e.dev&&e.ino===t.ino&&e.dev===t.dev}function xn(t,e){let r=U.resolve(t).split(U.sep).filter(i=>i),n=U.resolve(e).split(U.sep).filter(i=>i);return r.reduce((i,o,s)=>i&&n[s]===o,!0)}function ur(t,e,r){return`Cannot ${r} '${t}' to a subdirectory of itself, '${e}'.`}po.exports={checkPaths:bf,checkPathsSync:kf,checkParentPaths:fo,checkParentPathsSync:uo,isSrcSubdir:xn,areIdentical:kt}});var wo=x((ey,_o)=>{"use strict";var re=te(),Ct=v("path"),Cf=me().mkdirs,Of=Fe().pathExists,Lf=wn().utimesMillis,Ot=Qe();function Nf(t,e,r,n){typeof r=="function"&&!n?(n=r,r={}):typeof r=="function"&&(r={filter:r}),n=n||function(){},r=r||{},r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0001"),Ot.checkPaths(t,e,"copy",r,(i,o)=>{if(i)return n(i);let{srcStat:s,destStat:a}=o;Ot.checkParentPaths(t,s,e,"copy",l=>{if(l)return n(l);ho(t,e,r,(f,c)=>{if(f)return n(f);if(!c)return n();Tf(a,t,e,r,n)})})})}function Tf(t,e,r,n,i){let o=Ct.dirname(r);Of(o,(s,a)=>{if(s)return i(s);if(a)return vn(t,e,r,n,i);Cf(o,l=>l?i(l):vn(t,e,r,n,i))})}function ho(t,e,r,n){if(!r.filter)return n(null,!0);Promise.resolve(r.filter(t,e)).then(i=>n(null,i),i=>n(i))}function vn(t,e,r,n,i){(n.dereference?re.stat:re.lstat)(e,(s,a)=>s?i(s):a.isDirectory()?Rf(a,t,e,r,n,i):a.isFile()||a.isCharacterDevice()||a.isBlockDevice()?Mf(a,t,e,r,n,i):a.isSymbolicLink()?Uf(t,e,r,n,i):a.isSocket()?i(new Error(`Cannot copy a socket file: ${e}`)):a.isFIFO()?i(new Error(`Cannot copy a FIFO pipe: ${e}`)):i(new Error(`Unknown file: ${e}`)))}function Mf(t,e,r,n,i,o){return e?If(t,r,n,i,o):go(t,r,n,i,o)}function If(t,e,r,n,i){if(n.overwrite)re.unlink(r,o=>o?i(o):go(t,e,r,n,i));else return n.errorOnExist?i(new Error(`'${r}' already exists`)):i()}function go(t,e,r,n,i){re.copyFile(e,r,o=>o?i(o):n.preserveTimestamps?Df(t.mode,e,r,i):pr(r,t.mode,i))}function Df(t,e,r,n){return Ff(t)?Af(r,t,i=>i?n(i):mo(t,e,r,n)):mo(t,e,r,n)}function Ff(t){return(t&128)===0}function Af(t,e,r){return pr(t,e|128,r)}function mo(t,e,r,n){$f(e,r,i=>i?n(i):pr(r,t,n))}function pr(t,e,r){return re.chmod(t,e,r)}function $f(t,e,r){re.stat(t,(n,i)=>n?r(n):Lf(e,i.atime,i.mtime,r))}function Rf(t,e,r,n,i,o){return e?yo(r,n,i,o):Bf(t.mode,r,n,i,o)}function Bf(t,e,r,n,i){re.mkdir(r,o=>{if(o)return i(o);yo(e,r,n,s=>s?i(s):pr(r,t,i))})}function yo(t,e,r,n){re.readdir(t,(i,o)=>i?n(i):Sn(o,t,e,r,n))}function Sn(t,e,r,n,i){let o=t.pop();return o?jf(t,o,e,r,n,i):i()}function jf(t,e,r,n,i,o){let s=Ct.join(r,e),a=Ct.join(n,e);ho(s,a,i,(l,f)=>{if(l)return o(l);if(!f)return Sn(t,r,n,i,o);Ot.checkPaths(s,a,"copy",i,(c,u)=>{if(c)return o(c);let{destStat:p}=u;vn(p,s,a,i,d=>d?o(d):Sn(t,r,n,i,o))})})}function Uf(t,e,r,n,i){re.readlink(e,(o,s)=>{if(o)return i(o);if(n.dereference&&(s=Ct.resolve(process.cwd(),s)),t)re.readlink(r,(a,l)=>a?a.code==="EINVAL"||a.code==="UNKNOWN"?re.symlink(s,r,i):i(a):(n.dereference&&(l=Ct.resolve(process.cwd(),l)),Ot.isSrcSubdir(s,l)?i(new Error(`Cannot copy '${s}' to a subdirectory of itself, '${l}'.`)):Ot.isSrcSubdir(l,s)?i(new Error(`Cannot overwrite '${l}' with '${s}'.`)):qf(s,r,i)));else return re.symlink(s,r,i)})}function qf(t,e,r){re.unlink(e,n=>n?r(n):re.symlink(t,e,r))}_o.exports=Nf});var Po=x((ty,Eo)=>{"use strict";var X=te(),Lt=v("path"),Wf=me().mkdirsSync,Vf=wn().utimesMillisSync,Nt=Qe();function Hf(t,e,r){typeof r=="function"&&(r={filter:r}),r=r||{},r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0002");let{srcStat:n,destStat:i}=Nt.checkPathsSync(t,e,"copy",r);if(Nt.checkParentPathsSync(t,n,e,"copy"),r.filter&&!r.filter(t,e))return;let o=Lt.dirname(e);return X.existsSync(o)||Wf(o),xo(i,t,e,r)}function xo(t,e,r,n){let o=(n.dereference?X.statSync:X.lstatSync)(e);if(o.isDirectory())return Qf(o,t,e,r,n);if(o.isFile()||o.isCharacterDevice()||o.isBlockDevice())return Gf(o,t,e,r,n);if(o.isSymbolicLink())return tu(t,e,r,n);throw o.isSocket()?new Error(`Cannot copy a socket file: ${e}`):o.isFIFO()?new Error(`Cannot copy a FIFO pipe: ${e}`):new Error(`Unknown file: ${e}`)}function Gf(t,e,r,n,i){return e?Jf(t,r,n,i):vo(t,r,n,i)}function Jf(t,e,r,n){if(n.overwrite)return X.unlinkSync(r),vo(t,e,r,n);if(n.errorOnExist)throw new Error(`'${r}' already exists`)}function vo(t,e,r,n){return X.copyFileSync(e,r),n.preserveTimestamps&&zf(t.mode,e,r),En(r,t.mode)}function zf(t,e,r){return Yf(t)&&Kf(r,t),Xf(e,r)}function Yf(t){return(t&128)===0}function Kf(t,e){return En(t,e|128)}function En(t,e){return X.chmodSync(t,e)}function Xf(t,e){let r=X.statSync(t);return Vf(e,r.atime,r.mtime)}function Qf(t,e,r,n,i){return e?So(r,n,i):Zf(t.mode,r,n,i)}function Zf(t,e,r,n){return X.mkdirSync(r),So(e,r,n),En(r,t)}function So(t,e,r){X.readdirSync(t).forEach(n=>eu(n,t,e,r))}function eu(t,e,r,n){let i=Lt.join(e,t),o=Lt.join(r,t);if(n.filter&&!n.filter(i,o))return;let{destStat:s}=Nt.checkPathsSync(i,o,"copy",n);return xo(s,i,o,n)}function tu(t,e,r,n){let i=X.readlinkSync(e);if(n.dereference&&(i=Lt.resolve(process.cwd(),i)),t){let o;try{o=X.readlinkSync(r)}catch(s){if(s.code==="EINVAL"||s.code==="UNKNOWN")return X.symlinkSync(i,r);throw s}if(n.dereference&&(o=Lt.resolve(process.cwd(),o)),Nt.isSrcSubdir(i,o))throw new Error(`Cannot copy '${i}' to a subdirectory of itself, '${o}'.`);if(Nt.isSrcSubdir(o,i))throw new Error(`Cannot overwrite '${o}' with '${i}'.`);return ru(i,r)}else return X.symlinkSync(i,r)}function ru(t,e){return X.unlinkSync(e),X.symlinkSync(t,e)}Eo.exports=Hf});var mr=x((ry,bo)=>{"use strict";var nu=ee().fromCallback;bo.exports={copy:nu(wo()),copySync:Po()}});var Tt=x((ny,Co)=>{"use strict";var ko=te(),iu=ee().fromCallback;function ou(t,e){ko.rm(t,{recursive:!0,force:!0},e)}function su(t){ko.rmSync(t,{recursive:!0,force:!0})}Co.exports={remove:iu(ou),removeSync:su}});var Fo=x((iy,Do)=>{"use strict";var au=ee().fromPromise,No=Xe(),To=v("path"),Mo=me(),Io=Tt(),Oo=au(async function(e){let r;try{r=await No.readdir(e)}catch{return Mo.mkdirs(e)}return Promise.all(r.map(n=>Io.remove(To.join(e,n))))});function Lo(t){let e;try{e=No.readdirSync(t)}catch{return Mo.mkdirsSync(t)}e.forEach(r=>{r=To.join(t,r),Io.removeSync(r)})}Do.exports={emptyDirSync:Lo,emptydirSync:Lo,emptyDir:Oo,emptydir:Oo}});var Bo=x((oy,Ro)=>{"use strict";var cu=ee().fromCallback,Ao=v("path"),Ae=te(),$o=me();function lu(t,e){function r(){Ae.writeFile(t,"",n=>{if(n)return e(n);e()})}Ae.stat(t,(n,i)=>{if(!n&&i.isFile())return e();let o=Ao.dirname(t);Ae.stat(o,(s,a)=>{if(s)return s.code==="ENOENT"?$o.mkdirs(o,l=>{if(l)return e(l);r()}):e(s);a.isDirectory()?r():Ae.readdir(o,l=>{if(l)return e(l)})})})}function fu(t){let e;try{e=Ae.statSync(t)}catch{}if(e&&e.isFile())return;let r=Ao.dirname(t);try{Ae.statSync(r).isDirectory()||Ae.readdirSync(r)}catch(n){if(n&&n.code==="ENOENT")$o.mkdirsSync(r);else throw n}Ae.writeFileSync(t,"")}Ro.exports={createFile:cu(lu),createFileSync:fu}});var Vo=x((sy,Wo)=>{"use strict";var uu=ee().fromCallback,jo=v("path"),$e=te(),Uo=me(),pu=Fe().pathExists,{areIdentical:qo}=Qe();function mu(t,e,r){function n(i,o){$e.link(i,o,s=>{if(s)return r(s);r(null)})}$e.lstat(e,(i,o)=>{$e.lstat(t,(s,a)=>{if(s)return s.message=s.message.replace("lstat","ensureLink"),r(s);if(o&&qo(a,o))return r(null);let l=jo.dirname(e);pu(l,(f,c)=>{if(f)return r(f);if(c)return n(t,e);Uo.mkdirs(l,u=>{if(u)return r(u);n(t,e)})})})})}function du(t,e){let r;try{r=$e.lstatSync(e)}catch{}try{let o=$e.lstatSync(t);if(r&&qo(o,r))return}catch(o){throw o.message=o.message.replace("lstat","ensureLink"),o}let n=jo.dirname(e);return $e.existsSync(n)||Uo.mkdirsSync(n),$e.linkSync(t,e)}Wo.exports={createLink:uu(mu),createLinkSync:du}});var Go=x((ay,Ho)=>{"use strict";var Re=v("path"),Mt=te(),hu=Fe().pathExists;function gu(t,e,r){if(Re.isAbsolute(t))return Mt.lstat(t,n=>n?(n.message=n.message.replace("lstat","ensureSymlink"),r(n)):r(null,{toCwd:t,toDst:t}));{let n=Re.dirname(e),i=Re.join(n,t);return hu(i,(o,s)=>o?r(o):s?r(null,{toCwd:i,toDst:t}):Mt.lstat(t,a=>a?(a.message=a.message.replace("lstat","ensureSymlink"),r(a)):r(null,{toCwd:t,toDst:Re.relative(n,t)})))}}function yu(t,e){let r;if(Re.isAbsolute(t)){if(r=Mt.existsSync(t),!r)throw new Error("absolute srcpath does not exist");return{toCwd:t,toDst:t}}else{let n=Re.dirname(e),i=Re.join(n,t);if(r=Mt.existsSync(i),r)return{toCwd:i,toDst:t};if(r=Mt.existsSync(t),!r)throw new Error("relative srcpath does not exist");return{toCwd:t,toDst:Re.relative(n,t)}}}Ho.exports={symlinkPaths:gu,symlinkPathsSync:yu}});var Yo=x((cy,zo)=>{"use strict";var Jo=te();function _u(t,e,r){if(r=typeof e=="function"?e:r,e=typeof e=="function"?!1:e,e)return r(null,e);Jo.lstat(t,(n,i)=>{if(n)return r(null,"file");e=i&&i.isDirectory()?"dir":"file",r(null,e)})}function wu(t,e){let r;if(e)return e;try{r=Jo.lstatSync(t)}catch{return"file"}return r&&r.isDirectory()?"dir":"file"}zo.exports={symlinkType:_u,symlinkTypeSync:wu}});var ns=x((ly,rs)=>{"use strict";var xu=ee().fromCallback,Xo=v("path"),de=Xe(),Qo=me(),vu=Qo.mkdirs,Su=Qo.mkdirsSync,Zo=Go(),Eu=Zo.symlinkPaths,Pu=Zo.symlinkPathsSync,es=Yo(),bu=es.symlinkType,ku=es.symlinkTypeSync,Cu=Fe().pathExists,{areIdentical:ts}=Qe();function Ou(t,e,r,n){n=typeof r=="function"?r:n,r=typeof r=="function"?!1:r,de.lstat(e,(i,o)=>{!i&&o.isSymbolicLink()?Promise.all([de.stat(t),de.stat(e)]).then(([s,a])=>{if(ts(s,a))return n(null);Ko(t,e,r,n)}):Ko(t,e,r,n)})}function Ko(t,e,r,n){Eu(t,e,(i,o)=>{if(i)return n(i);t=o.toDst,bu(o.toCwd,r,(s,a)=>{if(s)return n(s);let l=Xo.dirname(e);Cu(l,(f,c)=>{if(f)return n(f);if(c)return de.symlink(t,e,a,n);vu(l,u=>{if(u)return n(u);de.symlink(t,e,a,n)})})})})}function Lu(t,e,r){let n;try{n=de.lstatSync(e)}catch{}if(n&&n.isSymbolicLink()){let a=de.statSync(t),l=de.statSync(e);if(ts(a,l))return}let i=Pu(t,e);t=i.toDst,r=ku(i.toCwd,r);let o=Xo.dirname(e);return de.existsSync(o)||Su(o),de.symlinkSync(t,e,r)}rs.exports={createSymlink:xu(Ou),createSymlinkSync:Lu}});var us=x((fy,fs)=>{"use strict";var{createFile:is,createFileSync:os}=Bo(),{createLink:ss,createLinkSync:as}=Vo(),{createSymlink:cs,createSymlinkSync:ls}=ns();fs.exports={createFile:is,createFileSync:os,ensureFile:is,ensureFileSync:os,createLink:ss,createLinkSync:as,ensureLink:ss,ensureLinkSync:as,createSymlink:cs,createSymlinkSync:ls,ensureSymlink:cs,ensureSymlinkSync:ls}});var dr=x((uy,ps)=>{function Nu(t,{EOL:e=`
`,finalEOL:r=!0,replacer:n=null,spaces:i}={}){let o=r?e:"";return JSON.stringify(t,n,i).replace(/\n/g,e)+o}function Tu(t){return Buffer.isBuffer(t)&&(t=t.toString("utf8")),t.replace(/^\uFEFF/,"")}ps.exports={stringify:Nu,stripBom:Tu}});var gs=x((py,hs)=>{var ft;try{ft=te()}catch{ft=v("fs")}var hr=ee(),{stringify:ms,stripBom:ds}=dr();async function Mu(t,e={}){typeof e=="string"&&(e={encoding:e});let r=e.fs||ft,n="throws"in e?e.throws:!0,i=await hr.fromCallback(r.readFile)(t,e);i=ds(i);let o;try{o=JSON.parse(i,e?e.reviver:null)}catch(s){if(n)throw s.message=`${t}: ${s.message}`,s;return null}return o}var Iu=hr.fromPromise(Mu);function Du(t,e={}){typeof e=="string"&&(e={encoding:e});let r=e.fs||ft,n="throws"in e?e.throws:!0;try{let i=r.readFileSync(t,e);return i=ds(i),JSON.parse(i,e.reviver)}catch(i){if(n)throw i.message=`${t}: ${i.message}`,i;return null}}async function Fu(t,e,r={}){let n=r.fs||ft,i=ms(e,r);await hr.fromCallback(n.writeFile)(t,i,r)}var Au=hr.fromPromise(Fu);function $u(t,e,r={}){let n=r.fs||ft,i=ms(e,r);return n.writeFileSync(t,i,r)}var Ru={readFile:Iu,readFileSync:Du,writeFile:Au,writeFileSync:$u};hs.exports=Ru});var _s=x((my,ys)=>{"use strict";var gr=gs();ys.exports={readJson:gr.readFile,readJsonSync:gr.readFileSync,writeJson:gr.writeFile,writeJsonSync:gr.writeFileSync}});var yr=x((dy,vs)=>{"use strict";var Bu=ee().fromCallback,It=te(),ws=v("path"),xs=me(),ju=Fe().pathExists;function Uu(t,e,r,n){typeof r=="function"&&(n=r,r="utf8");let i=ws.dirname(t);ju(i,(o,s)=>{if(o)return n(o);if(s)return It.writeFile(t,e,r,n);xs.mkdirs(i,a=>{if(a)return n(a);It.writeFile(t,e,r,n)})})}function qu(t,...e){let r=ws.dirname(t);if(It.existsSync(r))return It.writeFileSync(t,...e);xs.mkdirsSync(r),It.writeFileSync(t,...e)}vs.exports={outputFile:Bu(Uu),outputFileSync:qu}});var Es=x((hy,Ss)=>{"use strict";var{stringify:Wu}=dr(),{outputFile:Vu}=yr();async function Hu(t,e,r={}){let n=Wu(e,r);await Vu(t,n,r)}Ss.exports=Hu});var bs=x((gy,Ps)=>{"use strict";var{stringify:Gu}=dr(),{outputFileSync:Ju}=yr();function zu(t,e,r){let n=Gu(e,r);Ju(t,n,r)}Ps.exports=zu});var Cs=x((yy,ks)=>{"use strict";var Yu=ee().fromPromise,Q=_s();Q.outputJson=Yu(Es());Q.outputJsonSync=bs();Q.outputJSON=Q.outputJson;Q.outputJSONSync=Q.outputJsonSync;Q.writeJSON=Q.writeJson;Q.writeJSONSync=Q.writeJsonSync;Q.readJSON=Q.readJson;Q.readJSONSync=Q.readJsonSync;ks.exports=Q});var Ms=x((_y,Ts)=>{"use strict";var Ku=te(),bn=v("path"),Xu=mr().copy,Ns=Tt().remove,Qu=me().mkdirp,Zu=Fe().pathExists,Os=Qe();function ep(t,e,r,n){typeof r=="function"&&(n=r,r={}),r=r||{};let i=r.overwrite||r.clobber||!1;Os.checkPaths(t,e,"move",r,(o,s)=>{if(o)return n(o);let{srcStat:a,isChangingCase:l=!1}=s;Os.checkParentPaths(t,a,e,"move",f=>{if(f)return n(f);if(tp(e))return Ls(t,e,i,l,n);Qu(bn.dirname(e),c=>c?n(c):Ls(t,e,i,l,n))})})}function tp(t){let e=bn.dirname(t);return bn.parse(e).root===e}function Ls(t,e,r,n,i){if(n)return Pn(t,e,r,i);if(r)return Ns(e,o=>o?i(o):Pn(t,e,r,i));Zu(e,(o,s)=>o?i(o):s?i(new Error("dest already exists.")):Pn(t,e,r,i))}function Pn(t,e,r,n){Ku.rename(t,e,i=>i?i.code!=="EXDEV"?n(i):rp(t,e,r,n):n())}function rp(t,e,r,n){Xu(t,e,{overwrite:r,errorOnExist:!0,preserveTimestamps:!0},o=>o?n(o):Ns(t,n))}Ts.exports=ep});var $s=x((wy,As)=>{"use strict";var Ds=te(),Cn=v("path"),np=mr().copySync,Fs=Tt().removeSync,ip=me().mkdirpSync,Is=Qe();function op(t,e,r){r=r||{};let n=r.overwrite||r.clobber||!1,{srcStat:i,isChangingCase:o=!1}=Is.checkPathsSync(t,e,"move",r);return Is.checkParentPathsSync(t,i,e,"move"),sp(e)||ip(Cn.dirname(e)),ap(t,e,n,o)}function sp(t){let e=Cn.dirname(t);return Cn.parse(e).root===e}function ap(t,e,r,n){if(n)return kn(t,e,r);if(r)return Fs(e),kn(t,e,r);if(Ds.existsSync(e))throw new Error("dest already exists.");return kn(t,e,r)}function kn(t,e,r){try{Ds.renameSync(t,e)}catch(n){if(n.code!=="EXDEV")throw n;return cp(t,e,r)}}function cp(t,e,r){return np(t,e,{overwrite:r,errorOnExist:!0,preserveTimestamps:!0}),Fs(t)}As.exports=op});var Bs=x((xy,Rs)=>{"use strict";var lp=ee().fromCallback;Rs.exports={move:lp(Ms()),moveSync:$s()}});var J=x((vy,js)=>{"use strict";js.exports={...Xe(),...mr(),...Fo(),...us(),...Cs(),...me(),...Bs(),...yr(),...Fe(),...Tt()}});var Us,qs=y(()=>{Us=()=>`
# See https://help.github.com/articles/ignoring-files/ for more about ignoring files.

# dependencies
/node_modules
/.pnp
.pnp.js

# testing
/coverage

#cache
.turbo
.next
.vercel

# misc
.DS_Store
*.pem

# debug
npm-debug.log*
yarn-debug.log*
yarn-error.log*
.pnpm-debug.log*


# local env files
.env*

out/
build/
dist/

# plasmo - https://www.plasmo.com
.plasmo

# bpp - http://bpp.browser.market/
keys.json

# typescript
.tsbuildinfo
`});import{userInfo as fp}from"os";import{sentenceCase as up}from"change-case";import pp from"package-json";var mp,Ws,On,Ln=y(()=>{mp=async({name:t="plasmo-extension",version:e="0.0.1",packageManager:r={}})=>{let n={name:t,displayName:up(t),version:e,description:"A basic Plasmo extension.",author:fp().username,packageManager:void 0,scripts:{dev:"plasmo dev",build:"plasmo build",package:"plasmo package"},dependencies:{plasmo:"workspace:*",react:"*","react-dom":"*"},devDependencies:{"@types/chrome":"*","@types/node":"*","@types/react":"*","@types/react-dom":"*",prettier:"*",typescript:"*"},manifest:{host_permissions:["https://*/*"]}};return!r||!r.version?delete n.packageManager:n.packageManager=`${r.name}@${r.version}`,n},Ws=async t=>await mp(t),On=async t=>{let e={};return await Promise.all(Object.entries(t).map(async([r,n])=>{if(r==="plasmo")e[r]="0.84.2";else if(n==="workspace:*")try{let i=await pp(r,{version:"latest"});e[r]=i.version}catch{e[r]=n}else e[r]=n})),e}});import{dirname as dp,resolve as ut}from"path";import{fileURLToPath as hp}from"url";var _r,Nn=y(()=>{_r=()=>{let t=dp(hp(import.meta.url)),e=ut(t,"..","templates"),r=ut(e,"static"),n=ut(v.resolve("@plasmohq/init"),".."),i=ut(n,"templates"),o=ut(n,"entries"),s=ut(n,"bpp.yml");return{templatePath:e,initTemplatePath:i,initEntryPath:o,staticTemplatePath:r,bppYaml:s}}});import gp from"inquirer";var pt,Tn=y(()=>{pt=async(t="",e="")=>{let{data:r}=await gp.prompt({name:"data",prefix:"\u{1F7E1}",message:t,default:e});return r}});import{readFile as yp}from"fs/promises";import{extname as _p}from"path";import{strFromU8 as wp,unzipSync as xp}from"fflate";async function vp(t,e,r){if(t.content_security_policy&&(m("Convert content_security_policy"),e.manifest.content_security_policy={extension_pages:t.content_security_policy}),t.web_accessible_resources&&(m("Convert web_accessible_resources"),e.manifest.web_accessible_resources=[{matches:["https://*/*"],resources:t.web_accessible_resources}]),t.permissions){m("Convert permissions"),e.manifest.permissions=[],e.manifest.host_permissions=[];for(let n of t.permissions)n.startsWith("http")||n==="<all_urls>"?e.manifest.host_permissions.push(n):e.manifest.permissions.push(n)}t.browser_action&&(m("Convert browser_action"),e.manifest.action={default_title:t.browser_action.default_title}),t.background&&m("Convert background")}async function Sp(t,e,r){t.content_security_policy&&(m("Convert content_security_policy"),e.manifest.content_security_policy={...t.content_security_policy}),t.web_accessible_resources&&(m("Convert web_accessible_resources"),e.manifest.web_accessible_resources=[...t.web_accessible_resources]),t.permissions&&(m("Transfer permissions"),e.manifest.permissions=[...t.permissions]),t.host_permissions&&(m("Transfer host_permissions"),e.manifest.host_permissions=[...t.host_permissions]),t.action&&(m("Convert browser_action"),e.manifest.action={default_title:t.action.default_title}),t.background&&m("Convert background")}var Vs,Hs,Gs,Js=y(()=>{Vs=A(J(),1);b();Ln();Hs=async t=>{let e={unzipped:{},isZip:!1,manifestData:{}},r=_p(t);if(r===".zip"){let n=await yp(t);e.unzipped=xp(n),e.isZip=!0,e.manifestData=JSON.parse(wp(e.unzipped["manifest.json"]))}else if(r===".json")e.manifestData=await(0,Vs.readJson)(t);else return null;return e},Gs=async(t,e,{manifestData:r})=>{let n=await Ws({name:t.packageName,packageManager:e});switch(n.version=r.version,n.displayName=r.name,n.description=r.description,r?.author&&(n.author=r.author),r.homepage_url&&(n.homepage=r.homepage_url),r.version_name&&(n.manifest.version_name=r.version_name),r.browser_specific_settings&&(n.manifest.browser_specific_settings=r.browser_specific_settings),r.default_locale&&m("Convert locale"),r.options_ui&&m("Convert options_ui"),r.chrome_url_overrides&&m("Convert chrome_url_overrides"),r.icons&&m("Convert icons"),r.content_scripts&&m("Convert content_scripts"),r.manifest_version){case 2:await vp(r,n,t);break;case 3:await Sp(r,n,t);break;default:throw new Error("Unknown manifest version")}return n}});import{existsSync as zs}from"fs";import{lstat as Ep,readFile as Pp,writeFile as bp}from"fs/promises";import{isAbsolute as kp,join as Cp,relative as Op,resolve as Dt}from"path";import Lp from"@expo/spawn-async";import{sentenceCase as Np}from"change-case";import Tp from"ignore";import{temporaryDirectory as Mp}from"tempy";var he,Ip,wr,Ys=y(()=>{he=A(J(),1);pe();Y();b();qs();Ln();Nn();Tn();Js();Ip=/(?:^--with-)(?:\w+-?)+(?:[^-]$)/,wr=class{constructor(e,r,n=!1){this.commonPath=e;this.packageManager=r;this.isExample=n}templatePath=_r();async create(){return await this.createFrom()||await this.createWith()||await this.createBlank()}async createFrom(){let e=H("--from");if(!e)return!1;let r=kp(e)?e:Dt(e),n=await Ep(r);return n.isFile()?await this.createFromManifest(r):n.isDirectory()?await this.createFromLocalTemplate(r):!1}async createFromLocalTemplate(e){let r=Tp().add(["node_modules",".git",".env*"]),n=Cp(e,".gitignore");if(await F(n)){let s=await Pp(n,"utf-8");r.add(s)}await(0,he.copy)(e,this.commonPath.projectDirectory,{filter:s=>s===e||!r.ignores(Op(e,s))});let o=await(0,he.readJson)(this.commonPath.packageFilePath);return await this.outputPackageData(o),M(`Creating new project from ${e}`),!0}async createFromManifest(e){let r=await Hs(e);if(r===null)return!1;await this.copyBlankInitFiles();let n=await Gs(this.commonPath,this.packageManager,r);return await this.outputPackageData(n,{resolveWorkspaceRefs:!0}),!0}async createWith(){let e=process.argv.find(r=>Ip.test(r));return e===void 0?!1:this.createWithExample(e.substring(2))}async createWithExample(e){let r=Mp();m(`Download examples to temporary directory: ${r}`);try{await Lp("git",["clone","--depth","1","https://github.com/PlasmoHQ/examples.git","."],{cwd:r,ignoreStdio:!0})}catch(o){if(o.errno==="ENOENT")throw new Error("Unable to clone example repo. `git` is not in PATH.")}let n=Dt(r,e);if(!zs(n))throw new Error(`Example ${e} not found. You may file an example request at: https://docs.plasmo.com/exp`);m("Copy example to project directory"),await Promise.all([(0,he.copy)(n,this.commonPath.projectDirectory),this.copyBppWorkflow()]);let i=await(0,he.readJson)(this.commonPath.packageFilePath);return await this.outputPackageData(i,{resolveWorkspaceRefs:!0}),M(`Creating new project ${e.split("-").join(" ")}`),!0}async createBlank(){return await this.createWithExample("with-popup"),!0}async outputPackageData(e,{resolveWorkspaceRefs:r=!1}={}){let{packageName:n,packageFilePath:i}=this.commonPath;if(e.name=n,e.displayName=Np(n),e.description=await pt("Extension description:",e.description),this.isExample)delete e.packageManager,e.contributors=[await pt("Contributor name:",e.author)],e.author="Plasmo Corp. <foss@plasmo.com>";else if(delete e.contributors,e.author=await pt("Author name:",e.author),r){m("Replace workspace refs with the latest package version from npm registry");let o=await Promise.all([On(e.dependencies),On(e.devDependencies)]);e.dependencies=o[0],e.devDependencies=o[1]}await(0,he.outputJson)(i,e,{spaces:2})}async copyBlankInitFiles(){let r=(H("--entry")||"popup").split(new RegExp(",|\\s")).flatMap(n=>[`${n}.ts`,`${n}.tsx`]).map(n=>[Dt(this.templatePath.initEntryPath,n),Dt(this.commonPath.projectDirectory,n)]).filter(([n])=>zs(n));m("Using the following entry files: ",r),await Promise.all([(0,he.copy)(this.templatePath.initTemplatePath,this.commonPath.projectDirectory),this.copyBppWorkflow(),bp(this.commonPath.gitIgnorePath,Us())]),await Promise.all(r.map(([n,i])=>(0,he.copy)(n,i)))}async copyBppWorkflow(){if(this.isExample||R("--no-bpp"))return;m("Copying BPP workflow...");let e=Dt(this.commonPath.projectDirectory,".github","workflows","submit.yml");return(0,he.copy)(this.templatePath.bppYaml,e)}}});import{createQuestId as Dp}from"mnemonic-id";var Ks,Xs=y(()=>{er();b();Tn();Ks=async()=>{let[t]=Zt("init");return t?(m("Using user-provided name:",t),t):(m("Prompting for the extension name"),await pt("Extension name:",Dp()))}});import xr from"@expo/spawn-async";async function Qs(t,e){if(!await F(t.gitIgnorePath))return!1;try{return await Fp(e)}catch(r){return Z(r.message),!1}}var Fp,Zs=y(()=>{Y();b();Fp=async t=>{let{default:e}=await import("chalk"),r={cwd:t,ignoreStdio:!0};try{return m("Checking if the root is a git repository"),await xr("git",["rev-parse","--is-inside-work-tree"],r),m(`${t} is a git repository, bailing ${e.bold("git init")}`),!1}catch(n){if(n.errno==="ENOENT")throw new Error("Unable to initialize git repo. `git` not in PATH.")}return M("Initializing git project..."),await xr("git",["init"],r),await xr("git",["add","--all"],r),await xr("git",["commit","-m","Created a new Plasmo extension"],r),m("Added all files to git and created the initial commit."),!0}});import Ap from"@expo/spawn-async";var ea,ta=y(()=>{b();ea=async(t,e)=>{try{M("Installing dependencies..."),await Ap(e.name,["install"],{cwd:t,stdio:"inherit"})}catch(r){Z(r.message)}}});var ra,na=y(()=>{b();ra=async(t,e,r,n)=>{let{default:i}=await import("chalk");Me("Your extension is ready in: ",i.yellowBright(t),`

    To start hacking, run:

`,t===e?"":`      cd ${r.packageName}
`,`      ${n.name} ${n.name==="npm"?"run dev":"dev"}
`,`
    Visit https://docs.plasmo.com for documentation and more examples.`)}});var ia={};ze(ia,{default:()=>Up});import{resolve as $p}from"path";import{cwd as Rp}from"process";import{kebabCase as Bp}from"change-case";async function jp(){fe();let t=R("--exp"),e=await Ks(),r=Rp(),n=$p(r,Bp(e)||e);m("Project directory:",n);let i=ot(n);if(m("Package name:",i.packageName),t&&!i.packageName.startsWith("with-"))throw new Error("Example extensions must have the `with-` prefix");await qi(n);let o=await st();m(`Using package manager: ${o.name} ${o?.version}`),await new wr(i,o,t).create(),await ea(n,o),await Qs(i,n),await ra(n,r,i,o)}var Up,oa=y(()=>{pe();Y();b();or();sr();Ye();Ys();Xs();Zs();ta();na();Up=jp});var la=x((L_,ca)=>{"use strict";var{Duplex:qp}=v("stream");function sa(t){t.emit("close")}function Wp(){!this.destroyed&&this._writableState.finished&&this.destroy()}function aa(t){this.removeListener("error",aa),this.destroy(),this.listenerCount("error")===0&&this.emit("error",t)}function Vp(t,e){let r=!0,n=new qp({...e,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return t.on("message",function(o,s){let a=!s&&n._readableState.objectMode?o.toString():o;n.push(a)||t.pause()}),t.once("error",function(o){n.destroyed||(r=!1,n.destroy(o))}),t.once("close",function(){n.destroyed||n.push(null)}),n._destroy=function(i,o){if(t.readyState===t.CLOSED){o(i),process.nextTick(sa,n);return}let s=!1;t.once("error",function(l){s=!0,o(l)}),t.once("close",function(){s||o(i),process.nextTick(sa,n)}),r&&t.terminate()},n._final=function(i){if(t.readyState===t.CONNECTING){t.once("open",function(){n._final(i)});return}t._socket!==null&&(t._socket._writableState.finished?(i(),n._readableState.endEmitted&&n.destroy()):(t._socket.once("finish",function(){i()}),t.close()))},n._read=function(){t.isPaused&&t.resume()},n._write=function(i,o,s){if(t.readyState===t.CONNECTING){t.once("open",function(){n._write(i,o,s)});return}t.send(i,s)},n.on("end",Wp),n.on("error",aa),n}ca.exports=Vp});var Be=x((N_,fa)=>{"use strict";fa.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}});var Ft=x((T_,vr)=>{"use strict";var{EMPTY_BUFFER:Hp}=Be(),Mn=Buffer[Symbol.species];function Gp(t,e){if(t.length===0)return Hp;if(t.length===1)return t[0];let r=Buffer.allocUnsafe(e),n=0;for(let i=0;i<t.length;i++){let o=t[i];r.set(o,n),n+=o.length}return n<e?new Mn(r.buffer,r.byteOffset,n):r}function ua(t,e,r,n,i){for(let o=0;o<i;o++)r[n+o]=t[o]^e[o&3]}function pa(t,e){for(let r=0;r<t.length;r++)t[r]^=e[r&3]}function Jp(t){return t.length===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.length)}function In(t){if(In.readOnly=!0,Buffer.isBuffer(t))return t;let e;return t instanceof ArrayBuffer?e=new Mn(t):ArrayBuffer.isView(t)?e=new Mn(t.buffer,t.byteOffset,t.byteLength):(e=Buffer.from(t),In.readOnly=!1),e}vr.exports={concat:Gp,mask:ua,toArrayBuffer:Jp,toBuffer:In,unmask:pa};if(!process.env.WS_NO_BUFFER_UTIL)try{let t=v("bufferutil");vr.exports.mask=function(e,r,n,i,o){o<48?ua(e,r,n,i,o):t.mask(e,r,n,i,o)},vr.exports.unmask=function(e,r){e.length<32?pa(e,r):t.unmask(e,r)}}catch{}});var ha=x((M_,da)=>{"use strict";var ma=Symbol("kDone"),Dn=Symbol("kRun"),Fn=class{constructor(e){this[ma]=()=>{this.pending--,this[Dn]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[Dn]()}[Dn](){if(this.pending!==this.concurrency&&this.jobs.length){let e=this.jobs.shift();this.pending++,e(this[ma])}}};da.exports=Fn});var Rt=x((I_,wa)=>{"use strict";var At=v("zlib"),ga=Ft(),zp=ha(),{kStatusCode:ya}=Be(),Yp=Buffer[Symbol.species],Kp=Buffer.from([0,0,255,255]),Pr=Symbol("permessage-deflate"),ke=Symbol("total-length"),$t=Symbol("callback"),je=Symbol("buffers"),Er=Symbol("error"),Sr,An=class{constructor(e,r,n){if(this._maxPayload=n|0,this._options=e||{},this._threshold=this._options.threshold!==void 0?this._options.threshold:1024,this._isServer=!!r,this._deflate=null,this._inflate=null,this.params=null,!Sr){let i=this._options.concurrencyLimit!==void 0?this._options.concurrencyLimit:10;Sr=new zp(i)}}static get extensionName(){return"permessage-deflate"}offer(){let e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:this._options.clientMaxWindowBits==null&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let e=this._deflate[$t];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){let r=this._options,n=e.find(i=>!(r.serverNoContextTakeover===!1&&i.server_no_context_takeover||i.server_max_window_bits&&(r.serverMaxWindowBits===!1||typeof r.serverMaxWindowBits=="number"&&r.serverMaxWindowBits>i.server_max_window_bits)||typeof r.clientMaxWindowBits=="number"&&!i.client_max_window_bits));if(!n)throw new Error("None of the extension offers can be accepted");return r.serverNoContextTakeover&&(n.server_no_context_takeover=!0),r.clientNoContextTakeover&&(n.client_no_context_takeover=!0),typeof r.serverMaxWindowBits=="number"&&(n.server_max_window_bits=r.serverMaxWindowBits),typeof r.clientMaxWindowBits=="number"?n.client_max_window_bits=r.clientMaxWindowBits:(n.client_max_window_bits===!0||r.clientMaxWindowBits===!1)&&delete n.client_max_window_bits,n}acceptAsClient(e){let r=e[0];if(this._options.clientNoContextTakeover===!1&&r.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(!r.client_max_window_bits)typeof this._options.clientMaxWindowBits=="number"&&(r.client_max_window_bits=this._options.clientMaxWindowBits);else if(this._options.clientMaxWindowBits===!1||typeof this._options.clientMaxWindowBits=="number"&&r.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"');return r}normalizeParams(e){return e.forEach(r=>{Object.keys(r).forEach(n=>{let i=r[n];if(i.length>1)throw new Error(`Parameter "${n}" must have only a single value`);if(i=i[0],n==="client_max_window_bits"){if(i!==!0){let o=+i;if(!Number.isInteger(o)||o<8||o>15)throw new TypeError(`Invalid value for parameter "${n}": ${i}`);i=o}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${n}": ${i}`)}else if(n==="server_max_window_bits"){let o=+i;if(!Number.isInteger(o)||o<8||o>15)throw new TypeError(`Invalid value for parameter "${n}": ${i}`);i=o}else if(n==="client_no_context_takeover"||n==="server_no_context_takeover"){if(i!==!0)throw new TypeError(`Invalid value for parameter "${n}": ${i}`)}else throw new Error(`Unknown parameter "${n}"`);r[n]=i})}),e}decompress(e,r,n){Sr.add(i=>{this._decompress(e,r,(o,s)=>{i(),n(o,s)})})}compress(e,r,n){Sr.add(i=>{this._compress(e,r,(o,s)=>{i(),n(o,s)})})}_decompress(e,r,n){let i=this._isServer?"client":"server";if(!this._inflate){let o=`${i}_max_window_bits`,s=typeof this.params[o]!="number"?At.Z_DEFAULT_WINDOWBITS:this.params[o];this._inflate=At.createInflateRaw({...this._options.zlibInflateOptions,windowBits:s}),this._inflate[Pr]=this,this._inflate[ke]=0,this._inflate[je]=[],this._inflate.on("error",Qp),this._inflate.on("data",_a)}this._inflate[$t]=n,this._inflate.write(e),r&&this._inflate.write(Kp),this._inflate.flush(()=>{let o=this._inflate[Er];if(o){this._inflate.close(),this._inflate=null,n(o);return}let s=ga.concat(this._inflate[je],this._inflate[ke]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[ke]=0,this._inflate[je]=[],r&&this.params[`${i}_no_context_takeover`]&&this._inflate.reset()),n(null,s)})}_compress(e,r,n){let i=this._isServer?"server":"client";if(!this._deflate){let o=`${i}_max_window_bits`,s=typeof this.params[o]!="number"?At.Z_DEFAULT_WINDOWBITS:this.params[o];this._deflate=At.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:s}),this._deflate[ke]=0,this._deflate[je]=[],this._deflate.on("data",Xp)}this._deflate[$t]=n,this._deflate.write(e),this._deflate.flush(At.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let o=ga.concat(this._deflate[je],this._deflate[ke]);r&&(o=new Yp(o.buffer,o.byteOffset,o.length-4)),this._deflate[$t]=null,this._deflate[ke]=0,this._deflate[je]=[],r&&this.params[`${i}_no_context_takeover`]&&this._deflate.reset(),n(null,o)})}};wa.exports=An;function Xp(t){this[je].push(t),this[ke]+=t.length}function _a(t){if(this[ke]+=t.length,this[Pr]._maxPayload<1||this[ke]<=this[Pr]._maxPayload){this[je].push(t);return}this[Er]=new RangeError("Max payload size exceeded"),this[Er].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[Er][ya]=1009,this.removeListener("data",_a),this.reset()}function Qp(t){this[Pr]._inflate=null,t[ya]=1007,this[$t](t)}});var Bt=x((D_,br)=>{"use strict";var{isUtf8:xa}=v("buffer"),Zp=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function em(t){return t>=1e3&&t<=1014&&t!==1004&&t!==1005&&t!==1006||t>=3e3&&t<=4999}function $n(t){let e=t.length,r=0;for(;r<e;)if(!(t[r]&128))r++;else if((t[r]&224)===192){if(r+1===e||(t[r+1]&192)!==128||(t[r]&254)===192)return!1;r+=2}else if((t[r]&240)===224){if(r+2>=e||(t[r+1]&192)!==128||(t[r+2]&192)!==128||t[r]===224&&(t[r+1]&224)===128||t[r]===237&&(t[r+1]&224)===160)return!1;r+=3}else if((t[r]&248)===240){if(r+3>=e||(t[r+1]&192)!==128||(t[r+2]&192)!==128||(t[r+3]&192)!==128||t[r]===240&&(t[r+1]&240)===128||t[r]===244&&t[r+1]>143||t[r]>244)return!1;r+=4}else return!1;return!0}br.exports={isValidStatusCode:em,isValidUTF8:$n,tokenChars:Zp};if(xa)br.exports.isValidUTF8=function(t){return t.length<24?$n(t):xa(t)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let t=v("utf-8-validate");br.exports.isValidUTF8=function(e){return e.length<32?$n(e):t(e)}}catch{}});var qn=x((F_,Oa)=>{"use strict";var{Writable:tm}=v("stream"),va=Rt(),{BINARY_TYPES:rm,EMPTY_BUFFER:Sa,kStatusCode:nm,kWebSocket:im}=Be(),{concat:Rn,toArrayBuffer:om,unmask:sm}=Ft(),{isValidStatusCode:am,isValidUTF8:Ea}=Bt(),kr=Buffer[Symbol.species],cm=Promise.resolve(),lm=typeof queueMicrotask=="function"?queueMicrotask:fm,mt=0,Pa=1,ba=2,ka=3,Bn=4,Ca=5,jn=6,Un=class extends tm{constructor(e={}){super(),this._binaryType=e.binaryType||rm[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=e.maxPayload|0,this._skipUTF8Validation=!!e.skipUTF8Validation,this[im]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=mt,this._loop=!1}_write(e,r,n){if(this._opcode===8&&this._state==mt)return n();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(n)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){let n=this._buffers[0];return this._buffers[0]=new kr(n.buffer,n.byteOffset+e,n.length-e),new kr(n.buffer,n.byteOffset,e)}let r=Buffer.allocUnsafe(e);do{let n=this._buffers[0],i=r.length-e;e>=n.length?r.set(this._buffers.shift(),i):(r.set(new Uint8Array(n.buffer,n.byteOffset,e),i),this._buffers[0]=new kr(n.buffer,n.byteOffset+e,n.length-e)),e-=n.length}while(e>0);return r}startLoop(e){let r;this._loop=!0;do switch(this._state){case mt:r=this.getInfo();break;case Pa:r=this.getPayloadLength16();break;case ba:r=this.getPayloadLength64();break;case ka:this.getMask();break;case Bn:r=this.getData(e);break;case Ca:this._loop=!1;return;default:this._loop=!1,lm(()=>{this._state=mt,this.startLoop(e)});return}while(this._loop);e(r)}getInfo(){if(this._bufferedBytes<2){this._loop=!1;return}let e=this.consume(2);if(e[0]&48)return this._loop=!1,q(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");let r=(e[0]&64)===64;if(r&&!this._extensions[va.extensionName])return this._loop=!1,q(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._fin=(e[0]&128)===128,this._opcode=e[0]&15,this._payloadLength=e[1]&127,this._opcode===0){if(r)return this._loop=!1,q(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(!this._fragmented)return this._loop=!1,q(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented)return this._loop=!1,q(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");this._compressed=r}else if(this._opcode>7&&this._opcode<11){if(!this._fin)return this._loop=!1,q(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");if(r)return this._loop=!1,q(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._payloadLength>125||this._opcode===8&&this._payloadLength===1)return this._loop=!1,q(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH")}else return this._loop=!1,q(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");if(!this._fin&&!this._fragmented&&(this._fragmented=this._opcode),this._masked=(e[1]&128)===128,this._isServer){if(!this._masked)return this._loop=!1,q(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK")}else if(this._masked)return this._loop=!1,q(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");if(this._payloadLength===126)this._state=Pa;else if(this._payloadLength===127)this._state=ba;else return this.haveLength()}getPayloadLength16(){if(this._bufferedBytes<2){this._loop=!1;return}return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength()}getPayloadLength64(){if(this._bufferedBytes<8){this._loop=!1;return}let e=this.consume(8),r=e.readUInt32BE(0);return r>Math.pow(2,53-32)-1?(this._loop=!1,q(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=r*Math.pow(2,32)+e.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,q(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");this._masked?this._state=ka:this._state=Bn}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=Bn}getData(e){let r=Sa;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}r=this.consume(this._payloadLength),this._masked&&this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3]&&sm(r,this._mask)}if(this._opcode>7)return this.controlMessage(r);if(this._compressed){this._state=Ca,this.decompress(r,e);return}return r.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(r)),this.dataMessage()}decompress(e,r){this._extensions[va.extensionName].decompress(e,this._fin,(i,o)=>{if(i)return r(i);if(o.length){if(this._messageLength+=o.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return r(q(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(o)}let s=this.dataMessage();if(s)return r(s);this.startLoop(r)})}dataMessage(){if(this._fin){let e=this._messageLength,r=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],this._opcode===2){let n;this._binaryType==="nodebuffer"?n=Rn(r,e):this._binaryType==="arraybuffer"?n=om(Rn(r,e)):n=r,this.emit("message",n,!0)}else{let n=Rn(r,e);if(!this._skipUTF8Validation&&!Ea(n))return this._loop=!1,q(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("message",n,!1)}}this._state=jn}controlMessage(e){if(this._opcode===8)if(this._loop=!1,e.length===0)this.emit("conclude",1005,Sa),this.end(),this._state=mt;else{let r=e.readUInt16BE(0);if(!am(r))return q(RangeError,`invalid status code ${r}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");let n=new kr(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!Ea(n))return q(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("conclude",r,n),this.end(),this._state=mt}else this._opcode===9?(this.emit("ping",e),this._state=jn):(this.emit("pong",e),this._state=jn)}};Oa.exports=Un;function q(t,e,r,n,i){let o=new t(r?`Invalid WebSocket frame: ${e}`:e);return Error.captureStackTrace(o,q),o.code=i,o[nm]=n,o}function fm(t){cm.then(t).catch(pm)}function um(t){throw t}function pm(t){process.nextTick(um,t)}});var Vn=x(($_,Ta)=>{"use strict";var{Duplex:A_}=v("stream"),{randomFillSync:mm}=v("crypto"),La=Rt(),{EMPTY_BUFFER:dm}=Be(),{isValidStatusCode:hm}=Bt(),{mask:Na,toBuffer:dt}=Ft(),ge=Symbol("kByteLength"),gm=Buffer.alloc(4),Wn=class t{constructor(e,r,n){this._extensions=r||{},n&&(this._generateMask=n,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,r){let n,i=!1,o=2,s=!1;r.mask&&(n=r.maskBuffer||gm,r.generateMask?r.generateMask(n):mm(n,0,4),s=(n[0]|n[1]|n[2]|n[3])===0,o=6);let a;typeof e=="string"?(!r.mask||s)&&r[ge]!==void 0?a=r[ge]:(e=Buffer.from(e),a=e.length):(a=e.length,i=r.mask&&r.readOnly&&!s);let l=a;a>=65536?(o+=8,l=127):a>125&&(o+=2,l=126);let f=Buffer.allocUnsafe(i?a+o:o);return f[0]=r.fin?r.opcode|128:r.opcode,r.rsv1&&(f[0]|=64),f[1]=l,l===126?f.writeUInt16BE(a,2):l===127&&(f[2]=f[3]=0,f.writeUIntBE(a,4,6)),r.mask?(f[1]|=128,f[o-4]=n[0],f[o-3]=n[1],f[o-2]=n[2],f[o-1]=n[3],s?[f,e]:i?(Na(e,n,f,o,a),[f]):(Na(e,n,e,0,a),[f,e])):[f,e]}close(e,r,n,i){let o;if(e===void 0)o=dm;else{if(typeof e!="number"||!hm(e))throw new TypeError("First argument must be a valid error code number");if(r===void 0||!r.length)o=Buffer.allocUnsafe(2),o.writeUInt16BE(e,0);else{let a=Buffer.byteLength(r);if(a>123)throw new RangeError("The message must not be greater than 123 bytes");o=Buffer.allocUnsafe(2+a),o.writeUInt16BE(e,0),typeof r=="string"?o.write(r,2):o.set(r,2)}}let s={[ge]:o.length,fin:!0,generateMask:this._generateMask,mask:n,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._deflating?this.enqueue([this.dispatch,o,!1,s,i]):this.sendFrame(t.frame(o,s),i)}ping(e,r,n){let i,o;if(typeof e=="string"?(i=Buffer.byteLength(e),o=!1):(e=dt(e),i=e.length,o=dt.readOnly),i>125)throw new RangeError("The data size must not be greater than 125 bytes");let s={[ge]:i,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:9,readOnly:o,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,s,n]):this.sendFrame(t.frame(e,s),n)}pong(e,r,n){let i,o;if(typeof e=="string"?(i=Buffer.byteLength(e),o=!1):(e=dt(e),i=e.length,o=dt.readOnly),i>125)throw new RangeError("The data size must not be greater than 125 bytes");let s={[ge]:i,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:10,readOnly:o,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,s,n]):this.sendFrame(t.frame(e,s),n)}send(e,r,n){let i=this._extensions[La.extensionName],o=r.binary?2:1,s=r.compress,a,l;if(typeof e=="string"?(a=Buffer.byteLength(e),l=!1):(e=dt(e),a=e.length,l=dt.readOnly),this._firstFragment?(this._firstFragment=!1,s&&i&&i.params[i._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(s=a>=i._threshold),this._compress=s):(s=!1,o=0),r.fin&&(this._firstFragment=!0),i){let f={[ge]:a,fin:r.fin,generateMask:this._generateMask,mask:r.mask,maskBuffer:this._maskBuffer,opcode:o,readOnly:l,rsv1:s};this._deflating?this.enqueue([this.dispatch,e,this._compress,f,n]):this.dispatch(e,this._compress,f,n)}else this.sendFrame(t.frame(e,{[ge]:a,fin:r.fin,generateMask:this._generateMask,mask:r.mask,maskBuffer:this._maskBuffer,opcode:o,readOnly:l,rsv1:!1}),n)}dispatch(e,r,n,i){if(!r){this.sendFrame(t.frame(e,n),i);return}let o=this._extensions[La.extensionName];this._bufferedBytes+=n[ge],this._deflating=!0,o.compress(e,n.fin,(s,a)=>{if(this._socket.destroyed){let l=new Error("The socket was closed while data was being compressed");typeof i=="function"&&i(l);for(let f=0;f<this._queue.length;f++){let c=this._queue[f],u=c[c.length-1];typeof u=="function"&&u(l)}return}this._bufferedBytes-=n[ge],this._deflating=!1,n.readOnly=!1,this.sendFrame(t.frame(a,n),i),this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){let e=this._queue.shift();this._bufferedBytes-=e[3][ge],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][ge],this._queue.push(e)}sendFrame(e,r){e.length===2?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],r),this._socket.uncork()):this._socket.write(e[0],r)}};Ta.exports=Wn});var ja=x((R_,Ba)=>{"use strict";var{kForOnEventAttribute:jt,kListener:Hn}=Be(),Ma=Symbol("kCode"),Ia=Symbol("kData"),Da=Symbol("kError"),Fa=Symbol("kMessage"),Aa=Symbol("kReason"),ht=Symbol("kTarget"),$a=Symbol("kType"),Ra=Symbol("kWasClean"),Ce=class{constructor(e){this[ht]=null,this[$a]=e}get target(){return this[ht]}get type(){return this[$a]}};Object.defineProperty(Ce.prototype,"target",{enumerable:!0});Object.defineProperty(Ce.prototype,"type",{enumerable:!0});var Ze=class extends Ce{constructor(e,r={}){super(e),this[Ma]=r.code===void 0?0:r.code,this[Aa]=r.reason===void 0?"":r.reason,this[Ra]=r.wasClean===void 0?!1:r.wasClean}get code(){return this[Ma]}get reason(){return this[Aa]}get wasClean(){return this[Ra]}};Object.defineProperty(Ze.prototype,"code",{enumerable:!0});Object.defineProperty(Ze.prototype,"reason",{enumerable:!0});Object.defineProperty(Ze.prototype,"wasClean",{enumerable:!0});var gt=class extends Ce{constructor(e,r={}){super(e),this[Da]=r.error===void 0?null:r.error,this[Fa]=r.message===void 0?"":r.message}get error(){return this[Da]}get message(){return this[Fa]}};Object.defineProperty(gt.prototype,"error",{enumerable:!0});Object.defineProperty(gt.prototype,"message",{enumerable:!0});var Ut=class extends Ce{constructor(e,r={}){super(e),this[Ia]=r.data===void 0?null:r.data}get data(){return this[Ia]}};Object.defineProperty(Ut.prototype,"data",{enumerable:!0});var ym={addEventListener(t,e,r={}){for(let i of this.listeners(t))if(!r[jt]&&i[Hn]===e&&!i[jt])return;let n;if(t==="message")n=function(o,s){let a=new Ut("message",{data:s?o:o.toString()});a[ht]=this,Cr(e,this,a)};else if(t==="close")n=function(o,s){let a=new Ze("close",{code:o,reason:s.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});a[ht]=this,Cr(e,this,a)};else if(t==="error")n=function(o){let s=new gt("error",{error:o,message:o.message});s[ht]=this,Cr(e,this,s)};else if(t==="open")n=function(){let o=new Ce("open");o[ht]=this,Cr(e,this,o)};else return;n[jt]=!!r[jt],n[Hn]=e,r.once?this.once(t,n):this.on(t,n)},removeEventListener(t,e){for(let r of this.listeners(t))if(r[Hn]===e&&!r[jt]){this.removeListener(t,r);break}}};Ba.exports={CloseEvent:Ze,ErrorEvent:gt,Event:Ce,EventTarget:ym,MessageEvent:Ut};function Cr(t,e,r){typeof t=="object"&&t.handleEvent?t.handleEvent.call(t,r):t.call(e,r)}});var Gn=x((B_,Ua)=>{"use strict";var{tokenChars:qt}=Bt();function ve(t,e,r){t[e]===void 0?t[e]=[r]:t[e].push(r)}function _m(t){let e=Object.create(null),r=Object.create(null),n=!1,i=!1,o=!1,s,a,l=-1,f=-1,c=-1,u=0;for(;u<t.length;u++)if(f=t.charCodeAt(u),s===void 0)if(c===-1&&qt[f]===1)l===-1&&(l=u);else if(u!==0&&(f===32||f===9))c===-1&&l!==-1&&(c=u);else if(f===59||f===44){if(l===-1)throw new SyntaxError(`Unexpected character at index ${u}`);c===-1&&(c=u);let d=t.slice(l,c);f===44?(ve(e,d,r),r=Object.create(null)):s=d,l=c=-1}else throw new SyntaxError(`Unexpected character at index ${u}`);else if(a===void 0)if(c===-1&&qt[f]===1)l===-1&&(l=u);else if(f===32||f===9)c===-1&&l!==-1&&(c=u);else if(f===59||f===44){if(l===-1)throw new SyntaxError(`Unexpected character at index ${u}`);c===-1&&(c=u),ve(r,t.slice(l,c),!0),f===44&&(ve(e,s,r),r=Object.create(null),s=void 0),l=c=-1}else if(f===61&&l!==-1&&c===-1)a=t.slice(l,u),l=c=-1;else throw new SyntaxError(`Unexpected character at index ${u}`);else if(i){if(qt[f]!==1)throw new SyntaxError(`Unexpected character at index ${u}`);l===-1?l=u:n||(n=!0),i=!1}else if(o)if(qt[f]===1)l===-1&&(l=u);else if(f===34&&l!==-1)o=!1,c=u;else if(f===92)i=!0;else throw new SyntaxError(`Unexpected character at index ${u}`);else if(f===34&&t.charCodeAt(u-1)===61)o=!0;else if(c===-1&&qt[f]===1)l===-1&&(l=u);else if(l!==-1&&(f===32||f===9))c===-1&&(c=u);else if(f===59||f===44){if(l===-1)throw new SyntaxError(`Unexpected character at index ${u}`);c===-1&&(c=u);let d=t.slice(l,c);n&&(d=d.replace(/\\/g,""),n=!1),ve(r,a,d),f===44&&(ve(e,s,r),r=Object.create(null),s=void 0),a=void 0,l=c=-1}else throw new SyntaxError(`Unexpected character at index ${u}`);if(l===-1||o||f===32||f===9)throw new SyntaxError("Unexpected end of input");c===-1&&(c=u);let p=t.slice(l,c);return s===void 0?ve(e,p,r):(a===void 0?ve(r,p,!0):n?ve(r,a,p.replace(/\\/g,"")):ve(r,a,p),ve(e,s,r)),e}function wm(t){return Object.keys(t).map(e=>{let r=t[e];return Array.isArray(r)||(r=[r]),r.map(n=>[e].concat(Object.keys(n).map(i=>{let o=n[i];return Array.isArray(o)||(o=[o]),o.map(s=>s===!0?i:`${i}=${s}`).join("; ")})).join("; ")).join(", ")}).join(", ")}Ua.exports={format:wm,parse:_m}});var Xn=x((q_,Qa)=>{"use strict";var xm=v("events"),vm=v("https"),Sm=v("http"),Va=v("net"),Em=v("tls"),{randomBytes:Pm,createHash:bm}=v("crypto"),{Duplex:j_,Readable:U_}=v("stream"),{URL:Jn}=v("url"),Ue=Rt(),km=qn(),Cm=Vn(),{BINARY_TYPES:qa,EMPTY_BUFFER:Or,GUID:Om,kForOnEventAttribute:zn,kListener:Lm,kStatusCode:Nm,kWebSocket:z,NOOP:Ha}=Be(),{EventTarget:{addEventListener:Tm,removeEventListener:Mm}}=ja(),{format:Im,parse:Dm}=Gn(),{toBuffer:Fm}=Ft(),Am=30*1e3,Ga=Symbol("kAborted"),Yn=[8,13],Oe=["CONNECTING","OPEN","CLOSING","CLOSED"],$m=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,$=class t extends xm{constructor(e,r,n){super(),this._binaryType=qa[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=Or,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=t.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,e!==null?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,r===void 0?r=[]:Array.isArray(r)||(typeof r=="object"&&r!==null?(n=r,r=[]):r=[r]),Ja(this,e,r,n)):this._isServer=!0}get binaryType(){return this._binaryType}set binaryType(e){qa.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,r,n){let i=new km({binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:n.maxPayload,skipUTF8Validation:n.skipUTF8Validation});this._sender=new Cm(e,this._extensions,n.generateMask),this._receiver=i,this._socket=e,i[z]=this,e[z]=this,i.on("conclude",jm),i.on("drain",Um),i.on("error",qm),i.on("message",Wm),i.on("ping",Vm),i.on("pong",Hm),e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),r.length>0&&e.unshift(r),e.on("close",Ya),e.on("data",Nr),e.on("end",Ka),e.on("error",Xa),this._readyState=t.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=t.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[Ue.extensionName]&&this._extensions[Ue.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=t.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,r){if(this.readyState!==t.CLOSED){if(this.readyState===t.CONNECTING){let n="WebSocket was closed before the connection was established";oe(this,this._req,n);return}if(this.readyState===t.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=t.CLOSING,this._sender.close(e,r,!this._isServer,n=>{n||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),Am)}}pause(){this.readyState===t.CONNECTING||this.readyState===t.CLOSED||(this._paused=!0,this._socket.pause())}ping(e,r,n){if(this.readyState===t.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(n=e,e=r=void 0):typeof r=="function"&&(n=r,r=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==t.OPEN){Kn(this,e,n);return}r===void 0&&(r=!this._isServer),this._sender.ping(e||Or,r,n)}pong(e,r,n){if(this.readyState===t.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(n=e,e=r=void 0):typeof r=="function"&&(n=r,r=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==t.OPEN){Kn(this,e,n);return}r===void 0&&(r=!this._isServer),this._sender.pong(e||Or,r,n)}resume(){this.readyState===t.CONNECTING||this.readyState===t.CLOSED||(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,r,n){if(this.readyState===t.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof r=="function"&&(n=r,r={}),typeof e=="number"&&(e=e.toString()),this.readyState!==t.OPEN){Kn(this,e,n);return}let i={binary:typeof e!="string",mask:!this._isServer,compress:!0,fin:!0,...r};this._extensions[Ue.extensionName]||(i.compress=!1),this._sender.send(e||Or,i,n)}terminate(){if(this.readyState!==t.CLOSED){if(this.readyState===t.CONNECTING){let e="WebSocket was closed before the connection was established";oe(this,this._req,e);return}this._socket&&(this._readyState=t.CLOSING,this._socket.destroy())}}};Object.defineProperty($,"CONNECTING",{enumerable:!0,value:Oe.indexOf("CONNECTING")});Object.defineProperty($.prototype,"CONNECTING",{enumerable:!0,value:Oe.indexOf("CONNECTING")});Object.defineProperty($,"OPEN",{enumerable:!0,value:Oe.indexOf("OPEN")});Object.defineProperty($.prototype,"OPEN",{enumerable:!0,value:Oe.indexOf("OPEN")});Object.defineProperty($,"CLOSING",{enumerable:!0,value:Oe.indexOf("CLOSING")});Object.defineProperty($.prototype,"CLOSING",{enumerable:!0,value:Oe.indexOf("CLOSING")});Object.defineProperty($,"CLOSED",{enumerable:!0,value:Oe.indexOf("CLOSED")});Object.defineProperty($.prototype,"CLOSED",{enumerable:!0,value:Oe.indexOf("CLOSED")});["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(t=>{Object.defineProperty($.prototype,t,{enumerable:!0})});["open","error","close","message"].forEach(t=>{Object.defineProperty($.prototype,`on${t}`,{enumerable:!0,get(){for(let e of this.listeners(t))if(e[zn])return e[Lm];return null},set(e){for(let r of this.listeners(t))if(r[zn]){this.removeListener(t,r);break}typeof e=="function"&&this.addEventListener(t,e,{[zn]:!0})}})});$.prototype.addEventListener=Tm;$.prototype.removeEventListener=Mm;Qa.exports=$;function Ja(t,e,r,n){let i={protocolVersion:Yn[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...n,createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(!Yn.includes(i.protocolVersion))throw new RangeError(`Unsupported protocol version: ${i.protocolVersion} (supported versions: ${Yn.join(", ")})`);let o;if(e instanceof Jn)o=e;else try{o=new Jn(e)}catch{throw new SyntaxError(`Invalid URL: ${e}`)}o.protocol==="http:"?o.protocol="ws:":o.protocol==="https:"&&(o.protocol="wss:"),t._url=o.href;let s=o.protocol==="wss:",a=o.protocol==="ws+unix:",l;if(o.protocol!=="ws:"&&!s&&!a?l=`The URL's protocol must be one of "ws:", "wss:", "http:", "https", or "ws+unix:"`:a&&!o.pathname?l="The URL's pathname is empty":o.hash&&(l="The URL contains a fragment identifier"),l){let g=new SyntaxError(l);if(t._redirects===0)throw g;Lr(t,g);return}let f=s?443:80,c=Pm(16).toString("base64"),u=s?vm.request:Sm.request,p=new Set,d;if(i.createConnection=s?Bm:Rm,i.defaultPort=i.defaultPort||f,i.port=o.port||f,i.host=o.hostname.startsWith("[")?o.hostname.slice(1,-1):o.hostname,i.headers={...i.headers,"Sec-WebSocket-Version":i.protocolVersion,"Sec-WebSocket-Key":c,Connection:"Upgrade",Upgrade:"websocket"},i.path=o.pathname+o.search,i.timeout=i.handshakeTimeout,i.perMessageDeflate&&(d=new Ue(i.perMessageDeflate!==!0?i.perMessageDeflate:{},!1,i.maxPayload),i.headers["Sec-WebSocket-Extensions"]=Im({[Ue.extensionName]:d.offer()})),r.length){for(let g of r){if(typeof g!="string"||!$m.test(g)||p.has(g))throw new SyntaxError("An invalid or duplicated subprotocol was specified");p.add(g)}i.headers["Sec-WebSocket-Protocol"]=r.join(",")}if(i.origin&&(i.protocolVersion<13?i.headers["Sec-WebSocket-Origin"]=i.origin:i.headers.Origin=i.origin),(o.username||o.password)&&(i.auth=`${o.username}:${o.password}`),a){let g=i.path.split(":");i.socketPath=g[0],i.path=g[1]}let h;if(i.followRedirects){if(t._redirects===0){t._originalIpc=a,t._originalSecure=s,t._originalHostOrSocketPath=a?i.socketPath:o.host;let g=n&&n.headers;if(n={...n,headers:{}},g)for(let[_,S]of Object.entries(g))n.headers[_.toLowerCase()]=S}else if(t.listenerCount("redirect")===0){let g=a?t._originalIpc?i.socketPath===t._originalHostOrSocketPath:!1:t._originalIpc?!1:o.host===t._originalHostOrSocketPath;(!g||t._originalSecure&&!s)&&(delete i.headers.authorization,delete i.headers.cookie,g||delete i.headers.host,i.auth=void 0)}i.auth&&!n.headers.authorization&&(n.headers.authorization="Basic "+Buffer.from(i.auth).toString("base64")),h=t._req=u(i),t._redirects&&t.emit("redirect",t.url,h)}else h=t._req=u(i);i.timeout&&h.on("timeout",()=>{oe(t,h,"Opening handshake has timed out")}),h.on("error",g=>{h===null||h[Ga]||(h=t._req=null,Lr(t,g))}),h.on("response",g=>{let _=g.headers.location,S=g.statusCode;if(_&&i.followRedirects&&S>=300&&S<400){if(++t._redirects>i.maxRedirects){oe(t,h,"Maximum redirects exceeded");return}h.abort();let C;try{C=new Jn(_,e)}catch{let W=new SyntaxError(`Invalid URL: ${_}`);Lr(t,W);return}Ja(t,C,r,n)}else t.emit("unexpected-response",h,g)||oe(t,h,`Unexpected server response: ${g.statusCode}`)}),h.on("upgrade",(g,_,S)=>{if(t.emit("upgrade",g),t.readyState!==$.CONNECTING)return;if(h=t._req=null,g.headers.upgrade.toLowerCase()!=="websocket"){oe(t,_,"Invalid Upgrade header");return}let C=bm("sha1").update(c+Om).digest("base64");if(g.headers["sec-websocket-accept"]!==C){oe(t,_,"Invalid Sec-WebSocket-Accept header");return}let O=g.headers["sec-websocket-protocol"],W;if(O!==void 0?p.size?p.has(O)||(W="Server sent an invalid subprotocol"):W="Server sent a subprotocol but none was requested":p.size&&(W="Server sent no subprotocol"),W){oe(t,_,W);return}O&&(t._protocol=O);let Te=g.headers["sec-websocket-extensions"];if(Te!==void 0){if(!d){oe(t,_,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}let Pe;try{Pe=Dm(Te)}catch{oe(t,_,"Invalid Sec-WebSocket-Extensions header");return}let Je=Object.keys(Pe);if(Je.length!==1||Je[0]!==Ue.extensionName){oe(t,_,"Server indicated an extension that was not requested");return}try{d.accept(Pe[Ue.extensionName])}catch{oe(t,_,"Invalid Sec-WebSocket-Extensions header");return}t._extensions[Ue.extensionName]=d}t.setSocket(_,S,{generateMask:i.generateMask,maxPayload:i.maxPayload,skipUTF8Validation:i.skipUTF8Validation})}),i.finishRequest?i.finishRequest(h,t):h.end()}function Lr(t,e){t._readyState=$.CLOSING,t.emit("error",e),t.emitClose()}function Rm(t){return t.path=t.socketPath,Va.connect(t)}function Bm(t){return t.path=void 0,!t.servername&&t.servername!==""&&(t.servername=Va.isIP(t.host)?"":t.host),Em.connect(t)}function oe(t,e,r){t._readyState=$.CLOSING;let n=new Error(r);Error.captureStackTrace(n,oe),e.setHeader?(e[Ga]=!0,e.abort(),e.socket&&!e.socket.destroyed&&e.socket.destroy(),process.nextTick(Lr,t,n)):(e.destroy(n),e.once("error",t.emit.bind(t,"error")),e.once("close",t.emitClose.bind(t)))}function Kn(t,e,r){if(e){let n=Fm(e).length;t._socket?t._sender._bufferedBytes+=n:t._bufferedAmount+=n}if(r){let n=new Error(`WebSocket is not open: readyState ${t.readyState} (${Oe[t.readyState]})`);process.nextTick(r,n)}}function jm(t,e){let r=this[z];r._closeFrameReceived=!0,r._closeMessage=e,r._closeCode=t,r._socket[z]!==void 0&&(r._socket.removeListener("data",Nr),process.nextTick(za,r._socket),t===1005?r.close():r.close(t,e))}function Um(){let t=this[z];t.isPaused||t._socket.resume()}function qm(t){let e=this[z];e._socket[z]!==void 0&&(e._socket.removeListener("data",Nr),process.nextTick(za,e._socket),e.close(t[Nm])),e.emit("error",t)}function Wa(){this[z].emitClose()}function Wm(t,e){this[z].emit("message",t,e)}function Vm(t){let e=this[z];e.pong(t,!e._isServer,Ha),e.emit("ping",t)}function Hm(t){this[z].emit("pong",t)}function za(t){t.resume()}function Ya(){let t=this[z];this.removeListener("close",Ya),this.removeListener("data",Nr),this.removeListener("end",Ka),t._readyState=$.CLOSING;let e;!this._readableState.endEmitted&&!t._closeFrameReceived&&!t._receiver._writableState.errorEmitted&&(e=t._socket.read())!==null&&t._receiver.write(e),t._receiver.end(),this[z]=void 0,clearTimeout(t._closeTimer),t._receiver._writableState.finished||t._receiver._writableState.errorEmitted?t.emitClose():(t._receiver.on("error",Wa),t._receiver.on("finish",Wa))}function Nr(t){this[z]._receiver.write(t)||this.pause()}function Ka(){let t=this[z];t._readyState=$.CLOSING,t._receiver.end(),this.end()}function Xa(){let t=this[z];this.removeListener("error",Xa),this.on("error",Ha),t&&(t._readyState=$.CLOSING,this.destroy())}});var ec=x((W_,Za)=>{"use strict";var{tokenChars:Gm}=Bt();function Jm(t){let e=new Set,r=-1,n=-1,i=0;for(i;i<t.length;i++){let s=t.charCodeAt(i);if(n===-1&&Gm[s]===1)r===-1&&(r=i);else if(i!==0&&(s===32||s===9))n===-1&&r!==-1&&(n=i);else if(s===44){if(r===-1)throw new SyntaxError(`Unexpected character at index ${i}`);n===-1&&(n=i);let a=t.slice(r,n);if(e.has(a))throw new SyntaxError(`The "${a}" subprotocol is duplicated`);e.add(a),r=n=-1}else throw new SyntaxError(`Unexpected character at index ${i}`)}if(r===-1||n!==-1)throw new SyntaxError("Unexpected end of input");let o=t.slice(r,i);if(e.has(o))throw new SyntaxError(`The "${o}" subprotocol is duplicated`);return e.add(o),e}Za.exports={parse:Jm}});var ac=x((H_,sc)=>{"use strict";var zm=v("events"),Tr=v("http"),{Duplex:V_}=v("stream"),{createHash:Ym}=v("crypto"),tc=Gn(),et=Rt(),Km=ec(),Xm=Xn(),{GUID:Qm,kWebSocket:Zm}=Be(),ed=/^[+/0-9A-Za-z]{22}==$/,rc=0,nc=1,oc=2,Qn=class extends zm{constructor(e,r){if(super(),e={maxPayload:100*1024*1024,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:Xm,...e},e.port==null&&!e.server&&!e.noServer||e.port!=null&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(e.port!=null?(this._server=Tr.createServer((n,i)=>{let o=Tr.STATUS_CODES[426];i.writeHead(426,{"Content-Length":o.length,"Content-Type":"text/plain"}),i.end(o)}),this._server.listen(e.port,e.host,e.backlog,r)):e.server&&(this._server=e.server),this._server){let n=this.emit.bind(this,"connection");this._removeListeners=td(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(i,o,s)=>{this.handleUpgrade(i,o,s,n)}})}e.perMessageDeflate===!0&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=rc}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(this._state===oc){e&&this.once("close",()=>{e(new Error("The server is not running"))}),process.nextTick(Wt,this);return}if(e&&this.once("close",e),this._state!==nc)if(this._state=nc,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients?this.clients.size?this._shouldEmitClose=!0:process.nextTick(Wt,this):process.nextTick(Wt,this);else{let r=this._server;this._removeListeners(),this._removeListeners=this._server=null,r.close(()=>{Wt(this)})}}shouldHandle(e){if(this.options.path){let r=e.url.indexOf("?");if((r!==-1?e.url.slice(0,r):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,r,n,i){r.on("error",ic);let o=e.headers["sec-websocket-key"],s=+e.headers["sec-websocket-version"];if(e.method!=="GET"){tt(this,e,r,405,"Invalid HTTP method");return}if(e.headers.upgrade.toLowerCase()!=="websocket"){tt(this,e,r,400,"Invalid Upgrade header");return}if(!o||!ed.test(o)){tt(this,e,r,400,"Missing or invalid Sec-WebSocket-Key header");return}if(s!==8&&s!==13){tt(this,e,r,400,"Missing or invalid Sec-WebSocket-Version header");return}if(!this.shouldHandle(e)){Vt(r,400);return}let a=e.headers["sec-websocket-protocol"],l=new Set;if(a!==void 0)try{l=Km.parse(a)}catch{tt(this,e,r,400,"Invalid Sec-WebSocket-Protocol header");return}let f=e.headers["sec-websocket-extensions"],c={};if(this.options.perMessageDeflate&&f!==void 0){let u=new et(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let p=tc.parse(f);p[et.extensionName]&&(u.accept(p[et.extensionName]),c[et.extensionName]=u)}catch{tt(this,e,r,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let u={origin:e.headers[`${s===8?"sec-websocket-origin":"origin"}`],secure:!!(e.socket.authorized||e.socket.encrypted),req:e};if(this.options.verifyClient.length===2){this.options.verifyClient(u,(p,d,h,g)=>{if(!p)return Vt(r,d||401,h,g);this.completeUpgrade(c,o,l,e,r,n,i)});return}if(!this.options.verifyClient(u))return Vt(r,401)}this.completeUpgrade(c,o,l,e,r,n,i)}completeUpgrade(e,r,n,i,o,s,a){if(!o.readable||!o.writable)return o.destroy();if(o[Zm])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>rc)return Vt(o,503);let f=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${Ym("sha1").update(r+Qm).digest("base64")}`],c=new this.options.WebSocket(null);if(n.size){let u=this.options.handleProtocols?this.options.handleProtocols(n,i):n.values().next().value;u&&(f.push(`Sec-WebSocket-Protocol: ${u}`),c._protocol=u)}if(e[et.extensionName]){let u=e[et.extensionName].params,p=tc.format({[et.extensionName]:[u]});f.push(`Sec-WebSocket-Extensions: ${p}`),c._extensions=e}this.emit("headers",f,i),o.write(f.concat(`\r
`).join(`\r
`)),o.removeListener("error",ic),c.setSocket(o,s,{maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(c),c.on("close",()=>{this.clients.delete(c),this._shouldEmitClose&&!this.clients.size&&process.nextTick(Wt,this)})),a(c,i)}};sc.exports=Qn;function td(t,e){for(let r of Object.keys(e))t.on(r,e[r]);return function(){for(let n of Object.keys(e))t.removeListener(n,e[n])}}function Wt(t){t._state=oc,t.emit("close")}function ic(){this.destroy()}function Vt(t,e,r,n){r=r||Tr.STATUS_CODES[e],n={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(r),...n},t.once("finish",t.destroy),t.end(`HTTP/1.1 ${e} ${Tr.STATUS_CODES[e]}\r
`+Object.keys(n).map(i=>`${i}: ${n[i]}`).join(`\r
`)+`\r
\r
`+r)}function tt(t,e,r,n,i){if(t.listenerCount("wsClientError")){let o=new Error(i);Error.captureStackTrace(o,tt),t.emit("wsClientError",o,r,e)}else Vt(r,n,i)}});var rd,nd,id,Zn,ei,cc=y(()=>{rd=A(la(),1),nd=A(qn(),1),id=A(Vn(),1),Zn=A(Xn(),1),ei=A(ac(),1)});var lc=y(()=>{});var od,Mr,ti,uc,ri=y(()=>{cc();lc();od=(t,e)=>{let r=new ei.default({host:t,port:e+1});return{broadcast:i=>{for(let o of r.clients)o.readyState===Zn.default.OPEN&&o.send(JSON.stringify({type:i}))}}},ti=(t="localhost",e)=>{if(process.env.NODE_ENV==="production")return null;if(Mr)return Mr;if(!e)throw new Error("HMR port is not provided");return Mr=od(t,e),Mr},uc=t=>{if(process.env.NODE_ENV==="production")return;let e=ti();e&&e.broadcast(t)}});var yt,Ir=y(()=>{it();yt=()=>{let t=Ie(),{target:e,tag:r}=t,[n,i]=e.split("-");return{tag:r,target:e,browser:n,manifestVersion:i}}});import{AssertionError as sd}from"assert";function _t(t){throw new Error("Statement should be unreachable")}function ni(t,e="Value is invalid"){if(!t)throw new sd({message:e});return t}var Ht=y(()=>{});function pd(t){switch(t){case 0:return"Web";case 1:case 2:case 3:return hc[t];default:_t(t)}}var oi,Fr,si,Gt,ad,cd,pc,ld,fd,ud,ii,ai,We,Ve,se,mc,dc,rw,hc,Dr,nw,iw,gc,yc,ow,Se,qe,md,sw,dd,aw,cw,lw,fw,_c=y(()=>{Ht();oi="en",Fr=!1,si=!1,Gt=!1,ad=!1,cd=!1,pc=!1,ld=!1,fd=!1,ud=!1,ai=oi,Ve=typeof self=="object"?self:typeof global=="object"?global:{};typeof Ve.vscode<"u"&&typeof Ve.vscode.process<"u"?se=Ve.vscode.process:typeof process<"u"&&(se=process);mc=typeof se?.versions?.electron=="string",dc=mc&&se?.type==="renderer",rw=dc&&se?.sandboxed;typeof navigator=="object"&&!dc?(We=navigator.userAgent,Fr=We.indexOf("Windows")>=0,si=We.indexOf("Macintosh")>=0,fd=(We.indexOf("Macintosh")>=0||We.indexOf("iPad")>=0||We.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,Gt=We.indexOf("Linux")>=0,pc=!0,ii=navigator.language,ai=ii):typeof se=="object"?(Fr=se.platform==="win32",si=se.platform==="darwin",Gt=se.platform==="linux",ad=Gt&&!!se.env.SNAP&&!!se.env.SNAP_REVISION,ld=mc,ud=!!se.env.CI||!!se.env.BUILD_ARTIFACTSTAGINGDIRECTORY,ii=oi,ai=oi,cd=!0):console.error("Unable to resolve platform.");hc={1:"Mac",2:"Linux",3:"Windows"};Dr=0;si?Dr=1:Fr?Dr=3:Gt&&(Dr=2);nw=Object.values(hc),iw=pd(Dr),gc=Fr,yc=Gt,ow=pc&&typeof Ve.importScripts=="function",Se=We,qe=ai;(n=>{function t(){return qe}n.value=t;function e(){return qe.length===2?qe==="en":qe.length>=3?qe[0]==="e"&&qe[1]==="n"&&qe[2]==="-":!1}n.isDefaultVariant=e;function r(){return qe==="en"}n.isDefault=r})(md||={});sw=(()=>{if(typeof Ve.postMessage=="function"&&!Ve.importScripts){let t=[];Ve.addEventListener("message",r=>{if(r.data&&r.data.vscodeScheduleAsyncWork)for(let n=0,i=t.length;n<i;n++){let o=t[n];if(o.id===r.data.vscodeScheduleAsyncWork){t.splice(n,1),o.callback();return}}});let e=0;return r=>{let n=++e;t.push({id:n,callback:r}),Ve.postMessage({vscodeScheduleAsyncWork:n},"*")}}return t=>setTimeout(t)})(),dd=!!(Se&&Se.indexOf("Chrome")>=0),aw=!!(Se&&Se.indexOf("Firefox")>=0),cw=!!(!dd&&Se&&Se.indexOf("Safari")>=0),lw=!!(Se&&Se.indexOf("Edg/")>=0),fw=!!(Se&&Se.indexOf("Android")>=0)});var wc,xc=y(()=>{_c();wc=gc?"windows":yc?"inotify":"fs-events"});async function Le(t,e){for(let r of t)if(await e(r))return r}var Jt=y(()=>{});import{basename as hd,extname as vc,posix as gd,win32 as yd}from"path";var ae,Sc,wt=y(()=>{ae=t=>t.replaceAll(yd.sep,gd.sep),Sc=t=>vc(hd(t,vc(t)))});import{readFile as _d}from"fs/promises";import{resolve as wd}from"path";import{constantCase as xd}from"change-case";import vd from"dotenv";import{expand as Sd}from"dotenv-expand";function Pd(t){let e=Object.assign({},process.env);for(let{contents:r,name:n}of t)try{Pc.add(n);let i=Sd({ignoreProcessEnv:!0,parsed:vd.parse(r)});if(i.parsed){m(`Loaded env from ${n}`);let o=i.parsed||{};for(let[s,a]of Object.entries(o))if(typeof e[s]>"u"){try{e[s]=kd(a)}catch(l){le(`Failed to parse JSON directive ${s} in ${n}:`,l.message)}s.startsWith(Ec)&&(process.env[s]=a)}}}catch(i){le(`Failed to load env from ${n}`,i)}return e}function kd(t){let e=t.match(bd);return e?JSON.parse(e[1]):t}async function bc(t){let e=await Promise.all(li().map(o=>[o,wd(t,o)]).map(async([o,s])=>[o,s,await ir(s)&&await nr(s)])),r=await Promise.all(e.filter(([,,o])=>o).map(async([o,s])=>({name:o,contents:await _d(s,"utf8")}))),n=Pd(r),i=new ci(n);return{combinedEnv:n,plasmoPublicEnv:i,loadedEnvFiles:r}}var Ec,Ed,Pc,ci,bd,li,fi=y(()=>{Y();b();it();Ec="PLASMO_",Ed="PLASMO_PUBLIC_",Pc=new Set,ci=class t{data;constructor(e){this.data=Object.keys(e).filter(r=>r.startsWith(Ed)).reduce((r,n)=>(r[n]=e[n],r),{})}extends(e){M("Loaded environment variables from:",[...Pc]);let r=new t({...this.data});return r.data.NODE_ENV=process.env.NODE_ENV,Object.entries(e).forEach(([n,i])=>{r.data[`${Ec}${xd(n)}`]=i}),r}};bd=/^\s*json\((.+)\)\s*$/si;li=()=>{let t=process.env.NODE_ENV,e=Ie();return[e.envPath,`.env.${e.browser}.local`,`.env.${e.tag}.local`,`.env.${t}.local`,t!=="test"?".env.local":"",`.env.${e.browser}`,`.env.${e.tag}`,`.env.${t}`,".env"].filter(r=>!!r)}});import{resolve as Cd}from"path";async function Cc({commonPath:t,publicEnv:e}){let r=Object.keys(e.data);r.length!==0&&await(0,kc.outputFile)(Cd(t.dotPlasmoDirectory,Od),Ld(r))}var kc,ui,Od,Ld,pi=y(()=>{kc=A(J(),1),ui="process.env",Od=`${ui}.d.ts`,Ld=t=>`
declare namespace NodeJS {
  interface ProcessEnv {
${t.map(e=>`		${e}?: string`).join(`
`)}
  }
}
`});import Nd from"typescript";var ye,zt,Oc=y(()=>{({SyntaxKind:ye}=Nd),zt=t=>{switch(t.kind){case ye.StringLiteral:return t.text;case ye.TrueKeyword:return!0;case ye.FalseKeyword:return!1;case ye.NullKeyword:return null;case ye.NumericLiteral:return parseFloat(t.text);case ye.ArrayLiteralExpression:return t.elements.filter(e=>e.kind!==ye.SpreadElement).map(zt);case ye.ObjectLiteralExpression:return t.properties.filter(e=>e.kind===ye.PropertyAssignment&&(e.name.kind===ye.Identifier||e.name.kind===ye.StringLiteral)).map(e=>[e.name.escapedText||e.name.text,zt(e.initializer)]).reduce((e,[r,n])=>({...e,[r]:n}),{});default:return}}});import{readFile as Td}from"fs/promises";import Md from"typescript";var Id,Dd,Fd,Ad,$d,Lc,Nc=y(()=>{b();Oc();({ScriptTarget:Id,SyntaxKind:Dd,createSourceFile:Fd,isObjectLiteralExpression:Ad,isVariableStatement:$d}=Md),Lc=async t=>{try{let e=await Td(t,"utf8");if(e.length===0)return{isEmpty:!0};let n=Fd(t,e,Id.Latest,!0).statements.filter($d).reduce((s,a)=>(a.declarationList.forEachChild(l=>{s[l.name.getText()]=l.initializer}),s),{}),i=n.config;if(!i||!Ad(i))return null;let o=i.properties.reduce((s,a)=>{if(a.getChildCount()<3)return s;let[l,f,c]=a.getChildren(),u=l.getText();try{c.kind===Dd.Identifier?s[u]=zt(n[c.getText()]):s[u]=zt(c)}catch(p){le(p)}return s},{});return m("Parsed config:",o),{config:o}}catch(e){return m(e),null}}});import{basename as Tc,resolve as mi}from"path";import Ar from"sharp";async function $r({assetsDirectory:t,genAssetsDirectory:e}){if(xt.baseIconPaths.length===0){let o=Mc();xt.baseIconPaths=o.map(s=>mi(t,s))}let r=await Le(xt.baseIconPaths,F);if(r===void 0){Z("No icon found in assets directory");return}await(0,Yt.ensureDir)(e);let i=await Ar(r).toBuffer();m(`${r} found, creating resized icons`),await Promise.all(Bd.map(async o=>{if(xt.devProvidedIcons[o]===void 0){let l=Mc(di(o));xt.devProvidedIcons[o]=l.map(f=>mi(t,f))}let s=await Le(xt.devProvidedIcons[o],F),a=mi(e,`icon${o}.plasmo.png`);return process.env.NODE_ENV==="development"?s!==void 0?Tc(s).includes(".development.")?(0,Yt.copy)(s,a):Ar(s).grayscale().toFile(a):Ar(Buffer.from(i)).resize({width:o,height:o}).greyscale(!Tc(r).includes(".development.")).toFile(a):s!==void 0?(0,Yt.copy)(s,a):Ar(Buffer.from(i)).resize({width:o,height:o}).toFile(a)}))}var Yt,di,Rd,Mc,Bd,xt,hi=y(()=>{Yt=A(J(),1);Jt();Y();b();it();di=(t=512,e="icon")=>[`${e}${t}`,`${e}-${t}`,`${e}-${t}x${t}`],Rd=["icon",...di(),...di(1024)],Mc=(t=Rd)=>{let e=Ie();return t.map(r=>[`${r}.${e.tag}.${process.env.NODE_ENV}.png`,`${r}.${process.env.NODE_ENV}.png`,`${r}.${e.tag}.png`,`${r}.png`]).flat()},Bd=[128,64,48,32,16],xt={baseIconPaths:[],devProvidedIcons:{}}});import{resolve as ne}from"path";var ie,Ic,gi=y(()=>{fi();ie=(t,e)=>t.reduce((r,n)=>(r[n]=e,r),{}),Ic=({sourceDirectory:t,packageFilePath:e,assetsDirectory:r},n,i)=>{let o=P=>[".ts",...i,".js"].flatMap(L=>[ne(t,`${P}.${n}${L}`),ne(t,`${P}.${process.env.NODE_ENV}${L}`),ne(t,`${P}${L}`)]),s=(P,L=[".ts",".js"])=>L.flatMap(N=>[ne(t,`${P}.${n}${N}`),ne(t,P,`index.${n}${N}`),ne(t,`${P}.${process.env.NODE_ENV}${N}`),ne(t,P,`index.${process.env.NODE_ENV}${N}`),ne(t,`${P}${N}`),ne(t,P,`index${N}`)]),a=s("popup",i),l=s("options",i),f=s("devtools",i),c=s("newtab",i),u=s("sidepanel",i),p=s("popup",[".html"]),d=s("options",[".html"]),h=s("devtools",[".html"]),g=s("newtab",[".html"]),_=s("sidepanel",[".html"]),S=li().map(P=>ne(t,P)),C=s("background"),O=o("content"),W=o("sandbox"),Te={[e]:2,...ie(S,1),...ie(O,7),...ie(W,19),...ie(C,5),...ie(a,15),...ie(l,17),...ie(f,13),...ie(c,9),...ie(u,11),...ie(p,16),...ie(d,18),...ie(h,14),...ie(g,10),...ie(_,12)},Pe=ne(t,"contents"),Je=ne(t,"sandboxes"),we=ne(t,"tabs"),w=ne(t,"background"),k=[[20,Je],[4,we],[8,Pe],[6,w],[3,r]],E=new Set(Object.keys(Te)),B=new Set([...C,...O,...W,...a,...l,...f,...c,...u]);return{popupIndexList:a,popupHtmlList:p,optionsIndexList:l,optionsHtmlList:d,devtoolsIndexList:f,devtoolsHtmlList:h,newtabIndexList:c,newtabHtmlList:g,backgroundIndexList:C,backgroundDirectory:w,contentIndexList:O,contentsDirectory:Pe,sidepanelIndexList:u,sidepanelHtmlList:_,sandboxIndexList:W,sandboxesDirectory:Je,tabsDirectory:we,watchPathReasonMap:Te,watchDirectoryEntries:k,isEntryPath:P=>B.has(P),knownPathSet:E}}});import{resolve as jd}from"path";var Dc,yi,Ud,Fc,Ac,_i=y(()=>{Dc=A(J(),1),yi="messaging",Ud=`${yi}.d.ts`,Fc=(t,e)=>(0,Dc.outputFile)(jd(t.dotPlasmoDirectory,Ud),e),Ac=(t,e)=>`
import "@plasmohq/messaging"

interface MmMetadata {
	${t.join(`
	`)}
}

interface MpMetadata {
	${e.join(`
	`)}
}

declare module "@plasmohq/messaging" {
  interface MessagesMetadata extends MmMetadata {}
  interface PortsMetadata extends MpMetadata {}
}
`});import{readFile as qd}from"fs/promises";import{resolve as Rc}from"path";import Wd from"json5";var Rr,$c,Vd,Hd,Bc,jc=y(()=>{Rr=A(J(),1);_i();pi();$c=".plasmo/index.d.ts",Vd=[ui,yi].map(t=>`import "./${t}"`).join(`
`),Hd=async(t,e)=>{let r=Rc(t.projectDirectory,"tsconfig.json"),n=await qd(r,"utf8"),i=Wd.parse(n),o=new Set(i.include);o.has(e)||(i.include=[e,...o],await(0,Rr.outputJson)(r,i,{spaces:2}))},Bc=async t=>{let e=Rc(t.projectDirectory,$c);await Promise.all([(0,Rr.outputFile)(e,Vd),Hd(t,$c)])}});import{lstat as Gd}from"fs/promises";import{resolve as Jd}from"path";async function jr({dotPlasmoDirectory:t,cacheDirectory:e}){await(0,Br.emptyDir)(t),await(0,Br.ensureDir)(e)}async function Uc(t){let e=Jd(t.cacheDirectory,"parcel","data.mdb");if(!await F(e))return;let i=(await Gd(e,{bigint:!0})).size/1024n**2n,o=Number(i)/1024;o>1.47&&(m(`Busting large build cache, size: ${o.toFixed(2)} GB`),await jr(t))}var Br,wi=y(()=>{Br=A(J(),1);Y();b()});import zd from"package-json";import xi from"semver";async function Yd(t=""){switch((await st()).name){case"npm":return`"npm i -S plasmo@${t}"`;case"pnpm":return`"pnpm i plasmo@${t}"`;case"yarn":return`"yarn add plasmo@${t}"`}}var Ur,qc,vt,Kt=y(()=>{Ur=A(J(),1);Y();b();wi();sr();qc=async t=>{let{plasmoVersionFilePath:e}=t;if(!await F(e))m("Plasmo version file not found, busting cache..."),await jr(t);else{let r=await(0,Ur.readJson)(e),n=xi.coerce(r.version),i=xi.coerce("0.84.2");(!n||n.major<i.major||n.major===i.major&&n.minor<i.minor)&&(m("Plasmo updated, busting cache..."),await jr(t))}await(0,Ur.writeJson)(e,{version:"0.84.2"})},vt=async()=>{let t="0.84.2";try{let r=(await zd("plasmo",{version:"latest"})).version;if(xi.lt(t,r)){let{default:n}=await import("chalk");Z(n.yellowBright(`A new version of plasmo is available: v${r}`));let i=await Yd(r);Mi(n.yellow(`Run ${i} to update`))}}catch(e){le('Error fetching package information for "plasmo"',e)}}});var Kd,qr,Wc=y(()=>{b();Kd=t=>M({target:t}),qr=(t,e=Kd)=>{if(Array.isArray(t))return t.map(r=>qr(r,e)).filter(r=>r!==void 0);if(typeof t=="object"){let r={};for(let n in t)t.hasOwnProperty(n)&&(r[n]=qr(t[n],e),r[n]===void 0&&delete r[n]);return Object.keys(r).length===0?void 0:r}else return e(t)}});import{createHash as Xd}from"crypto";var Wr,vi=y(()=>{Wr=t=>Xd("md5").update(t).digest("hex").slice(0,18)});import{resolve as Gc}from"path";import{cwd as Qd}from"process";import Vc from"semver";var Jc,Zd,eh,th,zc,Hc,rh,Yc,Kc,Si=y(()=>{Jc=A(J(),1);Ht();Y();Ee();Zd=["react","svelte","vue","vanilla"],eh=[".tsx",".svelte",".vue",".jsx"],th=new Set(eh),zc=t=>th.has(t),Hc="No supported UI library found.  You can file an RFC for a new UI Library here: https://github.com/PlasmoHQ/plasmo/issues",rh=async t=>{if(t.includes(":")){let[e,r]=t.split(":");switch(e){case"file":default:let n=await(0,Jc.readJson)(Gc(Qd(),r,"package.json"));return Vc.coerce(n.version)?.major}}else return Vc.coerce(t)?.major},Yc=async t=>{let e=t.dependencies??{},r=Zd.find(s=>s in e);if(r===void 0)return{name:"vanilla",path:"vanilla",version:8427};let n=await rh(e[r]);if(n===void 0)throw new Error(Hc);if(r==="react"&&n<18)return{name:r,path:"react17",version:n};let i=`${r}${n}`,o=Gc(t.templatePath.staticTemplatePath,i);if(!await F(o))throw new Error(Hc);return{name:r,path:i,version:n}},Kc=t=>{switch(t){case"svelte":return{uiExts:[".svelte"],mountExt:".ts"};case"vue":return{uiExts:[".vue"],mountExt:".ts"};case"react":return{uiExts:[".tsx",".jsx"],mountExt:".tsx"};case"vanilla":return{uiExts:[".tsx",".jsx"],mountExt:".ts"};default:_t(t)}}});import{readFile as Xc,writeFile as nh}from"fs/promises";import{join as Ei,relative as ih,resolve as _e}from"path";var St,Vr,Qc=y(()=>{St=A(J(),1);Jt();Y();b();wt();vi();Ee();Si();Vr=class{constructor(e){this.plasmoManifest=e}#i={};#o={};get projectPath(){return this.plasmoManifest.projectPath}get commonPath(){return this.plasmoManifest.commonPath}get mountExt(){return this.plasmoManifest.mountExt}async init(){let[e,...r]=await Promise.all([this.#n(),this.#t("popup"),this.#t("options"),this.#t("newtab"),this.#t("devtools"),this.#t("sidepanel")]);return r}#n=async()=>{let e=_e(this.plasmoManifest.templatePath.staticTemplatePath,"common"),r=_e(this.commonPath.staticDirectory,"common");return(0,St.copy)(e,r)};#t=async e=>{m(`Creating static templates for ${e}`);let r=this.projectPath[`${e}IndexList`],n=this.projectPath[`${e}HtmlList`],[i,o]=await Promise.all([r,n].map(c=>Le(c,F))),{staticDirectory:s}=this.commonPath;await(0,St.ensureDir)(s);let a=i!==void 0,l=a?ae(ih(s,i)):`~${e}`,f=_e(s,`${e}${this.mountExt}`);return await Promise.all([this.#e(`index${this.mountExt}`,f,{__plasmo_import_module__:l}),this.createPageHtml(e,o)]),a};generateHtml=async(e="",r="",n="")=>{let i={__plasmo_static_index_title__:this.plasmoManifest.name,__plasmo_static_script__:r};return await ir(n)?this.#r(n,e,{...i,"</body>":`<div id="__plasmo"></div><script src="${r}" type="module"></script></body>`}):this.#e("index.html",e,i)};createPageHtml=async(e,r="")=>{let n=_e(this.commonPath.dotPlasmoDirectory,`${e}.html`),i=`./static/${e}${this.mountExt}`;return this.generateHtml(n,i,r)};createPageMount=async e=>{m(`Creating page mount template for ${e.dir}`);let r=_e(this.commonPath.dotPlasmoDirectory,e.dir),n=_e(r,`${e.name}.html`);await(0,St.ensureDir)(r);let i=zc(e.ext),o=_e(r,`${e.name}${this.mountExt}`),s=_e(this.commonPath.sourceDirectory,e.dir,`${e.name}.html`),a=await Promise.all(i?[this.#e(`index${this.mountExt}`,o,{__plasmo_import_module__:`~${ae(Ei(e.dir,e.name))}`}),this.generateHtml(n,`./${e.name}${this.mountExt}`,s)]:[this.generateHtml(n,`~${ae(Ei(e.dir,e.name))}${e.ext}`,s)]);return{htmlPath:n,wereFilesWritten:a.some(l=>l)}};createContentScriptMount=async e=>{m(`Creating content script mount for ${e.dir}`);let r=_e(this.commonPath.staticDirectory,e.dir);await(0,St.ensureDir)(r);let n=_e(r,`${e.name}${this.mountExt}`);return await this.#e(`content-script-ui-mount${this.mountExt}`,n,{__plasmo_mount_content_script__:`~${ae(Ei(e.dir,e.name))}`}),n};#s=async(e,r,n)=>{let i=Object.entries(n).reduce((s,[a,l])=>s.replaceAll(a,l),e),o=Wr(Buffer.from(i));return this.#o[r]===o?!1:(this.#o[r]=o,await nh(r,i),!0)};#r=async(e,r,n)=>{let i=await Xc(e,"utf8");return this.#s(i,r,n)};#e=async(e,r,n)=>(this.#i[e]||=await Xc(_e(this.plasmoManifest.staticScaffoldPath,e),"utf8"),this.#s(this.#i[e],r,n))}});import{ok as Ne}from"assert";import{readdir as Zc}from"fs/promises";import{basename as oh,dirname as sh,extname as el,isAbsolute as ah,join as ch,parse as tl,relative as Hr,resolve as rt}from"path";import{cwd as lh}from"process";import fh from"fast-glob";import{hasher as uh}from"node-object-hash";var ce,Xt,ph,mh,Et,Ee=y(()=>{ce=A(J(),1);ri();Ht();on();Y();b();wt();fi();pi();or();Nc();hi();gi();Nn();jc();wi();Kt();Wc();Qc();Si();Xt={16:"./gen-assets/icon16.plasmo.png",32:"./gen-assets/icon32.plasmo.png",48:"./gen-assets/icon48.plasmo.png",64:"./gen-assets/icon64.plasmo.png",128:"./gen-assets/icon128.plasmo.png"},ph=["storage"],mh=uh({trim:!0,sort:!0}),Et=class{constructor(e){this.bundleConfig=e;this.data.icons=Xt,this.scaffolder=new Vr(this)}get browser(){return this.bundleConfig.browser}#i;get commonPath(){return ni(this.#i)}#o;get projectPath(){return ni(this.#o)}templatePath=_r();#n;get combinedEnv(){return Ne(this.#n),this.#n.combinedEnv}get publicEnv(){return Ne(this.#n),this.#n.plasmoPublicEnv}#t=new Set([".ts",".js"]);#s=new Set;#r;get uiLibrary(){return Ne(this.#r),this.#r.uiLibrary}get mountExt(){return Ne(this.#r),this.#r.uiExtMap.mountExt}get uiExts(){return Ne(this.#r),this.#r.uiExtMap.uiExts}#e="";#a="";data={};overideManifest={};packageData;contentScriptMap=new Map;get mainWorldScriptList(){let e=[];for(let r of this.contentScriptMap.values())r.world==="MAIN"&&e.push(r);return e}get hasMainWorldScript(){for(let e of this.contentScriptMap.values())if(e.world==="MAIN")return!0;return!1}copyMap=new Map;permissionSet=new Set;scaffolder;get changed(){return this.#e!==this.#a}get name(){return Ne(this.packageData),this.packageData.displayName}get dependencies(){return Ne(this.packageData),this.packageData.dependencies??this.packageData.peerDependencies}get devDependencies(){return Ne(this.packageData),this.packageData.devDependencies}get staticScaffoldPath(){return Ne(this.uiLibrary),rt(this.templatePath.staticTemplatePath,this.uiLibrary.path)}async initEnv(e=lh()){this.#n=await bc(e),this.#i=ot(e)}async startup(){await this.initEnv(),m(`Ensure exists: ${this.commonPath.dotPlasmoDirectory}`),await(0,ce.ensureDir)(this.commonPath.dotPlasmoDirectory),await Uc(this.commonPath),await qc(this.commonPath),await $r(this.commonPath),await Bc(this.commonPath),await this.updateEnv(),await this.updatePackageData()}async postBuild(){await Promise.all(Array.from(this.copyMap,async([e,r])=>{await nr(e)||await(0,ce.copy)(r,e)}))}async updateEnv(){await this.initEnv(this.commonPath.projectDirectory),await Cc(this)}prefixDev=(e="")=>process.env.NODE_ENV==="development"?`DEV | ${e}`:e;async updatePackageData(){if(this.packageData=await(0,ce.readJson)(this.commonPath.packageFilePath),!this.packageData)throw new Error("Invalid package.json");this.data.version=this.packageData.version,this.data.author=this.packageData.author,this.data.name=this.prefixDev(this.packageData.displayName),this.data.description=this.packageData.description,this.packageData.homepage&&(this.data.homepage_url=this.packageData.homepage);for(let e of ph)`@plasmohq/${e}`in(this.packageData.dependencies||{})&&this.permissionSet.add(e);await this.#c(),this.overideManifest=await this.#l()}#c=async()=>{let e=await Yc(this),r=Kc(e.name);this.#r={uiLibrary:e,uiExtMap:r},this.#s=new Set(r.uiExts),this.uiExts.forEach(n=>{this.#t.add(n)}),this.#o=Ic(this.commonPath,this.browser,this.uiExts)};toggleOptions=(e=!1)=>(e?this.data.options_ui={page:"./options.html",open_in_tab:!0}:delete this.data.options_ui,this);toggleOverrides=(e,r=!1)=>(r?this.data.chrome_url_overrides={...this.data.chrome_url_overrides,[e]:`./${e}.html`}:delete this.data.chrome_url_overrides?.[e],this);toggleNewtab=(e=!1)=>this.toggleOverrides("newtab",e);toggleDevtools=(e=!1)=>(e?this.data.devtools_page="./devtools.html":delete this.data.devtools_page,this);isPathInvalid=e=>{if(e===void 0)return!0;let r=el(e);if(!this.#t.has(r))return!0;let n=Sc(e);return!!(n.length>0&&n!==`.${this.browser}`||n.length===0&&(0,ce.existsSync)(e.replace(r,`.${this.browser}${r}`)))};toggleContentScript=async(e,r=!1)=>{if(this.isPathInvalid(e))return!1;if(r){let n=await Lc(e);if(n?.isEmpty)return!1;m("Adding content script: ",e);let i=Hr(this.commonPath.dotPlasmoDirectory,e),o=el(i),s=this.#s.has(o);if(this.uiLibrary?.name!=="vanilla"&&s){let l=ch("lab",i).replace(/(^src)[\\/]/,""),f=tl(l);i=Hr(this.commonPath.dotPlasmoDirectory,await this.scaffolder.createContentScriptMount(f))}n?.config?.css&&n.config.css.length>0&&(n.config.css=n.config.css.map(l=>Hr(this.commonPath.dotPlasmoDirectory,rt(sh(e),l))));let a=this.injectEnvToObj({matches:["<all_urls>"],js:[n?.config?.world==="MAIN"?i.split(o)[0]:i],...n?.config||{}});this.contentScriptMap.set(e,a)}else this.contentScriptMap.delete(e);return uc("cs_changed"),r};addDirectory=async(e,r,n)=>(0,ce.existsSync)(e)?Zc(e,{withFileTypes:!0}).then(i=>Promise.all(i.filter(o=>o.isFile()&&n?n(o.name):!0).map(o=>rt(e,o.name)).map(o=>r(o,!0)))).then(i=>i.includes(!0)):!1;addContentScriptsIndexFiles=async()=>{let e=this.projectPath.contentsDirectory;if(!await Ui(e))return!1;let r=[...this.#t].flatMap(n=>[`index${n}`,`index.${this.browser}${n}`]);return Zc(e,{withFileTypes:!0}).then(n=>Promise.all(n.filter(i=>i.isDirectory()).map(i=>rt(e,i.name)).map(i=>this.addDirectory(i,this.toggleContentScript,o=>r.includes(o))))).then(n=>n.includes(!0))};addContentScriptsDirectory=async(e=this.projectPath.contentsDirectory)=>Promise.all([this.addDirectory(e,this.toggleContentScript),this.addContentScriptsIndexFiles()]).then(r=>r.includes(!0));togglePage=async(e,r=!1)=>{if(this.isPathInvalid(e))return!1;if(r){let n=Hr(this.commonPath.sourceDirectory,e),i=tl(n),{wereFilesWritten:o}=await this.scaffolder.createPageMount(i);o&&(this.#e="")}else this.#e="";return r};addPagesDirectory=async e=>this.addDirectory(e,this.togglePage);write=(e=!1)=>{this.#a=this.#e;let r=this.toJSON();if(this.#e=mh.hash(r),!(!this.changed&&!e))return m("Hash changed, updating manifest"),(0,ce.writeJson)(this.commonPath.entryManifestPath,r,{spaces:2})};toJSON=()=>{let e={...this.data},{options_ui:r,permissions:n,content_scripts:i,background:o,...s}=this.overideManifest;return e.options_ui?.page&&(e.options_ui={...e.options_ui,...r}),e.permissions=[...new Set([...this.permissionSet,...n||[]])],e.permissions?.length===0&&delete e.permissions,this.bundleConfig.manifestVersion==="mv2"&&(e.background={...e.background,...o},Object.keys(e.background).length===0&&delete e.background,s.host_permissions?.length>0&&(e.permissions=[...e.permissions||[],...s.host_permissions])),e.content_scripts=[...Array.from(this.contentScriptMap.values()).filter(a=>a.world!=="MAIN"),...i||[]],e.content_scripts.length===0&&delete e.content_scripts,{...e,...s}};#l=async()=>{if(!this.packageData?.manifest)return{};let e=await this.prepareOverrideManifest();if((e.web_accessible_resources?.length||0)>0&&(e.web_accessible_resources=await this.resolveWAR(this.packageData.manifest.web_accessible_resources)),e.browser_specific_settings)switch(this.browser){case"edge":case"safari":e.browser_specific_settings={[this.browser]:e.browser_specific_settings[this.browser]};break;case"firefox":case"gecko":e.browser_specific_settings={gecko:e.browser_specific_settings.gecko};break;default:delete e.browser_specific_settings}return this.injectEnvToObj(e)};copyProjectFile=async e=>{try{if(e.startsWith("~"))return this.copyProjectFile(e.slice(1));if(e.includes("*")){let o=await fh(e,{cwd:this.commonPath.projectDirectory,onlyFiles:!0});return await Promise.all(o.map(this.copyProjectFile)),e}let r=ah(e)?e:rt(this.commonPath.projectDirectory,e);if(!(!this.projectPath.isEntryPath(r)&&await(0,ce.pathExists)(r)))return e;let i=rt(this.commonPath.distDirectory,e);return this.copyMap.set(i,r),ae(e)}catch{return e}};copyNodeModuleFile=async e=>{try{let r=v.resolve(e,{paths:[this.commonPath.projectDirectory]}),n=oh(r),i=rt(this.commonPath.distDirectory,n);return this.copyMap.set(i,r),n}catch{return null}};injectEnvToObj=e=>qr(e,r=>typeof r!="string"?r:r.match(/^\$(\w+)$/)?this.combinedEnv[r.substring(1)]||void 0:Ni(r,this.combinedEnv))}});import{relative as dh,resolve as rl}from"path";var Gr,nl,il=y(()=>{Gr=A(J(),1);b();wt();Ee();nl=async({indexFilePath:t="",withMessaging:e=!1,withMainWorldScript:r=!1},n)=>{m("Creating BGSW entry");let i=rl(n.commonPath.staticDirectory,"background"),o=rl(i,"index.ts"),s=dh(i,t),a=[e&&'import "./messaging"',t&&`import "${ae(s).slice(0,-3)}"`,r&&'import "./main-world-scripts"'].filter(Boolean).join(`
`);await(0,Gr.ensureDir)(i),await(0,Gr.outputFile)(o,a)}});import{relative as hh,resolve as gh}from"path";import{camelCase as ol}from"change-case";var sl,al,cl=y(()=>{sl=A(J(),1);b();wt();Ee();al=async t=>{try{let e=gh(t.commonPath.staticDirectory,"background","main-world-scripts.ts"),r=t.mainWorldScriptList.map(i=>{let o=i.js.map(c=>{let u=ol(c),p=`url:${ae(hh(t.commonPath.entryManifestPath,c))}`;return{importName:u,importPath:p}}),s=o.map(c=>`import ${c.importName} from "${c.importPath}"`).join(`
`),a=o.map(c=>c.importName),l=Object.entries(i).reduce((c,[u,p])=>(u!=="js"&&(c[ol(u)]=p),c),{id:a.join("-"),js:[]}),f=JSON.stringify(l).replace(/"js":\[\]/,`"js":[${a.map(c=>`${c}.split("/").pop().split("?")[0]`).join(",")}]`);return[s,f]});if(r.length===0)return!1;t.permissionSet.add("scripting");let n=`${r.map(([i])=>i).join(`
`)}
chrome.scripting.registerContentScripts([
  ${r.map(([,i])=>i).join(`,
  `)}
]).catch(_ => {})
`;return await(0,sl.outputFile)(e,n),!0}catch(e){return m(e.message),!1}}});import{join as yh,resolve as _h}from"path";import{camelCase as wh}from"change-case";import xh from"fast-glob";var ul,ll,vh,fl,Sh,Eh,pl,ml=y(()=>{ul=A(J(),1);Y();b();wt();_i();vi();Ee();ll={md5Hash:""},vh=(t,e,r)=>`// @ts-nocheck
globalThis.__plasmoInternalPortMap = new Map()

${t}

chrome.runtime.onMessageExternal.addListener((request, sender, sendResponse) => {
  switch (request.name) {
    ${e}
    default:
      break
  }

  return true
})

chrome.runtime.onMessage.addListener((request, sender, sendResponse) => {
  switch (request.name) {
    ${e}
    default:
      break
  }

  return true
})

chrome.runtime.onConnect.addListener(function(port) {
  globalThis.__plasmoInternalPortMap.set(port.name, port)
  port.onMessage.addListener(function(request) {
    switch (port.name) {
      ${r}
      default:
        break
    }
  })
})

`,fl=async(t,e)=>{let r=yh(t.projectPath.backgroundDirectory,e);return await rr(r)?(await xh("**/*.ts",{cwd:r,onlyFiles:!0})).map(i=>{let s=ae(i).slice(0,-3),a=`${e}/${s}`,l=wh(a);return{importName:l,name:s,declaration:`"${s}" : {}`,importCode:`import { default as ${l} } from "~background/${a}"`}}):[]},Sh=(t,e)=>`case "${t}":
  ${e}({
    sender,
    ...request
  }, {
    send: (p) => sendResponse(p)
  })
  break`,Eh=(t,e)=>`case "${t}":
  ${e}({
    port,
    ...request
  }, {
    send: (p) => port.postMessage(p)
  })
  break`,pl=async t=>{try{let[e,r]=await Promise.all([fl(t,"messages"),fl(t,"ports")]);if(m({messageHandlerList:e,portHandlerList:r}),e.length===0&&r.length===0)return!1;if(!("@plasmohq/messaging"in t.dependencies))return Z("@plasmohq/messaging is not installed, skipping messaging API"),!1;let n=Ac(e.map(({declaration:s})=>s),r.map(({declaration:s})=>s)),i=Wr(Buffer.from(n));if(ll.md5Hash===i)return!0;ll.md5Hash=i;let o=vh([...e,...r].map(s=>s.importCode).join(`
`),e.map(s=>Sh(s.name,s.importName)).join(`
`),r.map(s=>Eh(s.name,s.importName)).join(`
`));return await Promise.all([(0,ul.outputFile)(_h(t.commonPath.staticDirectory,"background","messaging.ts"),o),Fc(t.commonPath,n)]),!0}catch(e){return m(e.message),!1}}});var Qt,Pi=y(()=>{Jt();Y();il();cl();ml();Ee();Qt=async t=>{let[e,r,n]=await Promise.all([Le(t.projectPath.backgroundIndexList,F),pl(t),al(t)]),i=!!e||r||n;return i&&await nl({indexFilePath:e,withMessaging:r,withMainWorldScript:n},t),t.toggleBackground(i)}});import{subscribe as Ph}from"@parcel/watcher";var bh,dl,kh,hl=y(()=>{xc();Ht();pe();b();Pi();Ee();hi();gi();bh=["node_modules","build",".plasmo","coverage",".git"],dl=async t=>{if(R("--impulse"))return null;let{default:e}=await import("is-path-inside"),{knownPathSet:r,watchPathReasonMap:n,watchDirectoryEntries:i}=t.projectPath;m("Watching the following files:",r);let o=s=>{if(r.has(s))return n[s];let a=i.find(([,l])=>e(s,l));return a?(r.add(s),n[s]=a[0]):0};return Ph(t.commonPath.projectDirectory,async(s,a)=>{if(s)throw s;await Promise.all(a.map(({path:l,type:f})=>kh(f,l,o(l),t))),await t.write()},{backend:wc,ignore:bh})},kh=async(t,e,r,n)=>{let i=t!=="delete";switch(r){case 0:return;case 1:{Z("Environment file change detected, please restart the dev server."),await n.updateEnv();return}case 3:{M("Assets directory changed, update dynamic assets"),await $r(n.commonPath);return}case 2:{M("package.json changed, updating manifest overides. You might need to restart the dev server."),await n.updatePackageData();return}case 6:case 5:{await Qt(n);return}case 7:case 8:{await n.toggleContentScript(e,i),n.hasMainWorldScript&&await Qt(n);return}case 19:case 20:case 4:{await n.togglePage(e,i);return}case 11:{n.toggleSidePanel(i);return}case 15:{n.togglePopup(i);return}case 17:{n.toggleOptions(i);return}case 13:{n.toggleDevtools(i);return}case 9:{n.toggleNewtab(i);return}case 16:{await n.scaffolder.createPageHtml("popup",i&&e);return}case 18:{await n.scaffolder.createPageHtml("options",i&&e);return}case 14:{await n.scaffolder.createPageHtml("devtools",i&&e);return}case 10:{await n.scaffolder.createPageHtml("newtab",i&&e);return}case 12:{await n.scaffolder.createPageHtml("sidepanel",i&&e);return}default:_t(r)}}});import{dirname as Ch,join as Oh,resolve as Lh}from"path";import Nh from"@parcel/fs";import Jr from"@parcel/package-manager";import{Parcel as Th}from"@plasmohq/parcel-core";var He,Mh,zr,bi=y(()=>{He=A(J(),1);pe();sr();Mh={npm:Jr.Npm,yarn:Jr.Yarn,pnpm:Jr.Pnpm},zr=async({commonPath:t,bundleConfig:e,publicEnv:r},{defaultTargetOptions:n={},...i})=>{let o=i.mode==="production";o?await(0,He.emptyDir)(t.distDirectory):await(0,He.ensureDir)(t.distDirectory),process.env.__PLASMO_FRAMEWORK_INTERNAL_NO_MINIFY=o&&R("--no-minify")?"true":"false",process.env.__PLASMO_FRAMEWORK_INTERNAL_SOURCE_MAPS=o?R("--inline-source-maps")?"inline":R("--source-maps")?"external":"none":R("--no-source-maps")?"none":"inline",process.env.__PLASMO_FRAMEWORK_INTERNAL_NO_CS_RELOAD=R("--no-cs-reload")?"true":"false",process.env.__PLASMO_FRAMEWORK_INTERNAL_ES_TARGET=H("--es-target")||"es2022";let s=await st(),a=new Nh.NodeFS,l=Mh[s.name],f=new Jr.NodePackageManager(a,t.projectDirectory,new l),c=v.resolve("@plasmohq/parcel-config"),u=Oh(Ch(c),"run.json"),p=await(0,He.readJson)(c);R("--bundle-buddy")&&(p.reporters=["...","@parcel/reporter-bundle-buddy"]),await(0,He.writeJson)(u,p);let d={browsers:e.manifestVersion==="mv2"&&e.browser!=="firefox"?["IE 11"]:["last 1 Chrome version"]};return new Th({inputFS:a,packageManager:f,entries:t.entryManifestPath,cacheDir:Lh(t.cacheDirectory,"parcel"),config:u,shouldAutoInstall:!0,env:r.extends(e).data,defaultTargetOptions:{...n,engines:d,sourceMaps:process.env.__PLASMO_FRAMEWORK_INTERNAL_SOURCE_MAPS!=="none",distDir:t.distDirectory},...i})}});var Yr,gl=y(()=>{b();Ee();Yr=class extends Et{constructor(e){super(e),this.data.manifest_version=2,this.data.browser_action={default_icon:Xt}}toggleSidePanel=(e=!1)=>{switch(this.browser){case"firefox":case"gecko":{e?this.data.sidebar_action={default_panel:"./sidepanel.html"}:delete this.data.sidebar_action;break}default:M("SidePanel is not available on chromium-based MV2 browsers, skipping.")}return this};togglePopup=(e=!1)=>(e?this.data.browser_action.default_popup="./popup.html":delete this.data.browser_action.default_popup,this);toggleBackground=(e=!1)=>(e?this.data.background={scripts:["./static/background/index.ts"]}:delete this.data.background,e);prepareOverrideManifest=()=>{let{manifest:e}=this.packageData,r={...e};return r.permissions=[...e.permissions||[],...e.host_permissions||[]],"host_permissions"in r&&delete r.host_permissions,"content_security_policy"in e&&(r.content_security_policy=e.content_security_policy?.extension_pages),r};resolveWAR=e=>Promise.all(e.map(async({resources:r})=>(await Promise.all(r.map(async i=>await this.copyNodeModuleFile(i)||await this.copyProjectFile(i)))).flat())).then(r=>r.flat())}});var Kr,yl=y(()=>{Ee();Kr=class extends Et{constructor(e){super(e),this.data.manifest_version=3,this.data.action={default_icon:Xt}}toggleSidePanel=(e=!1)=>{switch(this.browser){case"firefox":case"gecko":{e?this.data.sidebar_action={default_panel:"./sidepanel.html"}:delete this.data.sidebar_action;break}default:e?(this.data.side_panel={default_path:"./sidepanel.html"},this.permissionSet.add("sidePanel")):(delete this.data.side_panel,this.permissionSet.delete("sidePanel"))}return this};togglePopup=(e=!1)=>(e?this.data.action.default_popup="./popup.html":delete this.data.action.default_popup,this);toggleBackground=(e=!1)=>(e?this.data.background={service_worker:"./static/background/index.ts"}:delete this.data.background,e);prepareOverrideManifest=()=>({...this.packageData.manifest});resolveWAR=e=>Promise.all(e.map(async({resources:r,...n})=>({resources:(await Promise.all(r.map(async o=>await this.copyNodeModuleFile(o)||await this.copyProjectFile(o)))).flat(),...n})))}});async function Pt(t){m("Creating Manifest Factory...");let e=t.manifestVersion==="mv3"?new Kr(t):new Yr(t);await e.startup();let{contentIndexList:r,sandboxIndexList:n,tabsDirectory:i,sandboxesDirectory:o}=e.projectPath,[s,a]=await Promise.all([r,n].map(g=>Le(g,F))),l=await Promise.all([e.scaffolder.init(),e.togglePage(a,!0),e.toggleContentScript(s,!0),e.addContentScriptsDirectory(),e.addPagesDirectory(i),e.addPagesDirectory(o)]);l.push(await Qt(e));let f=l.flat();f.includes(!0)||Z("Unable to find any entry files. The extension might be empty");let[c,u,p,d,h]=f;return e.togglePopup(c).toggleOptions(u).toggleNewtab(p).toggleDevtools(d).toggleSidePanel(h),await e.write(!0),e}var Xr=y(()=>{Jt();Y();b();Pi();gl();yl()});var _l={};ze(_l,{default:()=>Dh});async function Ih(){fe(),await vt(),process.env.NODE_ENV="development";let t=H("--serve-port")||"1012",e=H("--serve-host")||"localhost",r=H("--hmr-port")||"1815",n=H("--hmr-host")||"localhost";M("Starting the extension development server...");let{default:i}=await import("get-port"),[o,s]=await Promise.all([i({port:parseInt(t)}),i({port:parseInt(r)})]),a=ti(n,s);m(`Starting dev server on ${e}:${o}, HMR on ${n}:${s}...`);let l=yt(),f=await Pt(l),c=await dl(f),u=await zr(f,{logLevel:"verbose",shouldBundleIncrementally:!0,serveOptions:{host:e,port:o},hmrOptions:{host:n,port:s}}),{default:p}=await import("chalk"),d=await u.watch(async(g,_)=>{if(g)throw g;_!==void 0&&(_.type==="buildSuccess"?(Me(`Extension re-packaged in ${p.bold(_.buildTime)}ms! \u{1F680}`),await f.postBuild(),a.broadcast("build_ready")):_.type==="buildFailure"&&(bt()||le(p.redBright(`Build failed. To debug, run ${p.bold("plasmo dev --verbose")}.`)),_.diagnostics.forEach(S=>{le(p.redBright(S.message)),S.stack&&m(S.stack),S.hints?.forEach(C=>{m(C)}),S.codeFrames?.forEach(C=>{C.code&&m(C.code),C.codeHighlights.forEach(O=>{O.message&&m(O.message),m(p.underline(`${C.filePath}:${O.start.line}:${O.start.column}`))})})})),process.env.__PLASMO_FRAMEWORK_INTERNAL_WATCHER_STARTED="true")}),h=()=>{c?.unsubscribe(),d.unsubscribe()};process.on("SIGINT",h),process.on("SIGTERM",h)}var Dh,wl=y(()=>{ri();pe();b();Ir();hl();Kt();bi();Ye();Xr();Dh=Ih});import{readdir as Fh,readFile as Ah,rename as xl,stat as $h,writeFile as Rh}from"fs/promises";import{join as Bh,resolve as jh}from"path";var Uh,ki,vl=y(()=>{Uh=async t=>{let r=(await Ah(jh(t),"utf8")).replace(/\/_/g,"/");await Rh(t,r,"utf8")},ki=async(t="")=>{let e=await Fh(t);for(let r of e){let n=Bh(t,r);if((await $h(n)).isDirectory()){let o=n.replace("/_","/");await xl(n,o),await ki(o)}else{let o=n.replace("/_","/");await xl(n,o),await Uh(o)}}}});import{mkdir as qh}from"fs/promises";import{resolve as Ci}from"path";import{sentenceCase as Wh}from"change-case";var Ge,Vh,Sl,El=y(()=>{Ge=A(J(),1);Y();b();or();vl();Vh=t=>({name:Wh(t.name),description:t.description,version:t.version,manifest_version:3,chrome_url_overrides:{newtab:"./index.html"}}),Sl=async()=>{let{projectDirectory:t,packageFilePath:e}=ot();m("Creating a Plasmo + Nextjs based new tab extension");let r=Ci(t,"out"),{default:n}=await import("chalk");if(!await F(r))throw new Error(`${n.bold("out")} directory does not exist, did you forget to run "${n.underline("next build && next export")}"?`);let i=await(0,Ge.readJson)(e),o=Ci(t,"extension");if(await F(o)){let{default:{prompt:s}}=await import("inquirer"),{answer:a}=await s({type:"confirm",name:"answer",message:`${n.bold("extension")} directory already exists, do you want to overwrite it?`});if(!a)throw new Error("Aborted");await(0,Ge.emptyDir)(o)}await qh(o),await(0,Ge.copy)(r,o),m("Extension created at:",o),await ki(o),await(0,Ge.writeJson)(Ci(o,"manifest.json"),Vh(i),{spaces:2}),Me("Your extension is ready in the extension/ directory")}});import{createReadStream as Hh,createWriteStream as Gh}from"fs";import{resolve as Pl}from"path";import Jh from"fast-glob";import{AsyncZipDeflate as zh,Zip as Yh}from"fflate";function Kh(t){return t/1024/1024}var Qr,Oi=y(()=>{b();Qr=async({distDirectory:t,buildDirectory:e,distDirectoryName:r},n=!1)=>{let i=Pl(e,`${r}.zip`),o=Gh(i),s=await Jh(["**/*",!n&&"!**/(*.js.map|*.css.map)"].filter(Boolean),{cwd:t,onlyFiles:!0});return new Promise((a,l)=>{let f=0,c=!1,u=Date.now(),p=new Yh((d,h,g)=>{c||(d?l(d):(f+=h.length,o.write(h),g&&(M(`Zip Package size: ${Kh(f).toFixed(2)} MB in ${Date.now()-u}ms`),o.end(),a())))});for(let d of s){if(c)return;let h=new zh(d,{level:9});p.add(h);let g=Pl(t,d);Hh(g).on("data",_=>{h.push(_,!1)}).on("end",()=>{h.push(new Uint8Array(0),!0)}).on("error",_=>{c=!0,p.terminate(),l(`Error reading file ${g}: ${_.message}`)})}p.end()})}});var bl={};ze(bl,{default:()=>Qh});async function Xh(){fe(),await vt(),process.env.NODE_ENV="production";let[t]=Zt("build");if(t==="next-new-tab"){await Sl();return}M("Prepare to bundle the extension...");let e=yt(),r=await Pt(e),i=await(await zr(r,{mode:"production",shouldDisableCache:!0,shouldContentHash:!1,defaultTargetOptions:{shouldOptimize:!0,shouldScopeHoist:R("--hoist")}})).run();Me(`Finished in ${i.buildTime}ms!`),await r.postBuild(),R("--zip")&&await Qr(r.commonPath)}var Qh,kl=y(()=>{er();pe();b();Ir();El();Kt();bi();Ye();Xr();Oi();Qh=Xh});var Cl={};ze(Cl,{default:()=>eg});async function Zh(){fe(),await vt(),process.env.NODE_ENV="production",M("Prepare to package the extension bundle...");let t=yt(),e=await Pt(t);await Qr(e.commonPath,R("--with-source-maps"))}var eg,Ol=y(()=>{pe();b();Ir();Kt();Ye();Xr();Oi();eg=Zh});var Zr={};ze(Zr,{default:()=>rg});async function tg(){console.log("0.84.2")}var rg,en=y(()=>{rg=tg});var tn,sn,Ll,an=y(()=>{tn={help:()=>Promise.resolve().then(()=>($i(),Ai)),start:()=>Promise.resolve().then(()=>(Bi(),Ri)),init:()=>Promise.resolve().then(()=>(oa(),ia)),dev:()=>Promise.resolve().then(()=>(wl(),_l)),build:()=>Promise.resolve().then(()=>(kl(),bl)),package:()=>Promise.resolve().then(()=>(Ol(),Cl)),version:()=>Promise.resolve().then(()=>(en(),Zr)),"-v":()=>Promise.resolve().then(()=>(en(),Zr)),"--version":()=>Promise.resolve().then(()=>(en(),Zr))},sn=Object.keys(tn),Ll=new Set(sn)});import{argv as Nl,exit as Li,versions as ng}from"process";import ig from"semver";pe();b();b();import{stdout as Ii}from"process";var Ul=t=>new Promise(e=>setTimeout(e,t));async function Di(t){for(let e=t;e>0;e--)Ii.write(`${"\u{1F534} EXIT".padEnd(9)} | This program will terminate in ${e} seconds...\r`),await Ul(1e3);Ii?.clearLine(0),xe("\u{1F534} EXIT","\u{1F44B} Good bye and have a great day!")}an();Ye();async function og(){fe(),tr()}async function sg(){try{if(Nl.length>10)throw new Error("Too many arguments provided.");if(ig.major(ng.node)<16)throw new Error("Node version must be >= 16");process.env.VERBOSE=Ti?"true":"false";let t=Nl.find(e=>Ll.has(e));if(t in tn){m("Running command:",t);let{default:e}=await tn[t]();await e()}else m("Running default mode"),await og()}catch(t){le(t.message||"Unknown error."),m(t.stack),await Di(3),Li(1)}}sg();process.on("SIGINT",()=>Li(0));process.on("SIGTERM",()=>Li(0));
